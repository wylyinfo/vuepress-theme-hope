<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.5" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html"><meta property="og:site_name" content="åšå®¢æ¼”ç¤º"><meta property="og:title" content="æ•°æ®ç»“æ„"><meta property="og:description" content="æ•°æ®ç»“æ„ ç ”ç©¶éæ•°å€¼è®¡ç®—çš„ç¨‹åºè®¾è®¡é—®é¢˜ä¸­çš„æ“ä½œå¯¹è±¡ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»å’Œæ“ä½œç­‰ç›¸å…³é—®é¢˜ é€»è¾‘ç»“æ„ï¼šé›†åˆç»“æ„ã€çº¿æ€§ç»“æ„ã€æ ‘å½¢ç»“æ„ã€å›¾å½¢ç»“æ„ ç‰©ç†ç»“æ„ï¼šé¡ºåºå­˜å‚¨ç»“æ„ã€é“¾å¼å­˜å‚¨ç»“æ„ ç¨‹åºè¿è¡Œæ—¶é—´ï¼Œä¾èµ–äºç®—æ³•å¥½åå’Œé—®é¢˜è¾“å…¥è§„æ¨¡ï¼ˆå¿½ç•¥å› ç´ ï¼šè½¯ä»¶ç¼–è¯‘äº§ç”Ÿçš„ä»£ç è´¨é‡ï¼Œç¡¬ä»¶æœºå™¨æ‰§è¡ŒæŒ‡ä»¤çš„é€Ÿåº¦ï¼‰ çº¿æ€§ç»“æ„ é¡ºåºå­˜å‚¨ï¼šå­˜å–æ•°æ®æ—¶é—´å¤æ‚åº¦o(1)ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(n)ï¼Œé€‚åˆæ•°æ®å­˜å–ï¼Œéœ€è¦é¢„åˆ†é…å­˜å‚¨ç©ºé—´ é“¾å¼å­˜å‚¨ï¼šå­˜å–æ•°æ®æ—¶é—´å¤æ‚åº¦o(n)ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(1)ï¼Œé€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤ æ ˆä¸é˜Ÿåˆ—"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-12-17T11:44:33.000Z"><meta property="article:author" content="Mr.Hope"><meta property="article:modified_time" content="2023-12-17T11:44:33.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"æ•°æ®ç»“æ„","image":[""],"dateModified":"2023-12-17T11:44:33.000Z","author":[{"@type":"Person","name":"Mr.Hope","url":"https://mister-hope.com"}]}</script><title>æ•°æ®ç»“æ„ | åšå®¢æ¼”ç¤º</title><meta name="description" content="æ•°æ®ç»“æ„ ç ”ç©¶éæ•°å€¼è®¡ç®—çš„ç¨‹åºè®¾è®¡é—®é¢˜ä¸­çš„æ“ä½œå¯¹è±¡ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»å’Œæ“ä½œç­‰ç›¸å…³é—®é¢˜ é€»è¾‘ç»“æ„ï¼šé›†åˆç»“æ„ã€çº¿æ€§ç»“æ„ã€æ ‘å½¢ç»“æ„ã€å›¾å½¢ç»“æ„ ç‰©ç†ç»“æ„ï¼šé¡ºåºå­˜å‚¨ç»“æ„ã€é“¾å¼å­˜å‚¨ç»“æ„ ç¨‹åºè¿è¡Œæ—¶é—´ï¼Œä¾èµ–äºç®—æ³•å¥½åå’Œé—®é¢˜è¾“å…¥è§„æ¨¡ï¼ˆå¿½ç•¥å› ç´ ï¼šè½¯ä»¶ç¼–è¯‘äº§ç”Ÿçš„ä»£ç è´¨é‡ï¼Œç¡¬ä»¶æœºå™¨æ‰§è¡ŒæŒ‡ä»¤çš„é€Ÿåº¦ï¼‰ çº¿æ€§ç»“æ„ é¡ºåºå­˜å‚¨ï¼šå­˜å–æ•°æ®æ—¶é—´å¤æ‚åº¦o(1)ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(n)ï¼Œé€‚åˆæ•°æ®å­˜å–ï¼Œéœ€è¦é¢„åˆ†é…å­˜å‚¨ç©ºé—´ é“¾å¼å­˜å‚¨ï¼šå­˜å–æ•°æ®æ—¶é—´å¤æ‚åº¦o(n)ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(1)ï¼Œé€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤ æ ˆä¸é˜Ÿåˆ—">
    <link rel="preload" href="/assets/style-64i7rTmW.css" as="style"><link rel="stylesheet" href="/assets/style-64i7rTmW.css">
    <link rel="modulepreload" href="/assets/app-lybKqyLW.js"><link rel="modulepreload" href="/assets/å¤§è¯æ•°æ®ç»“æ„.html-bgqRdMQQ.js"><link rel="modulepreload" href="/assets/å¤§è¯æ•°æ®ç»“æ„.html-1nNqm3L-.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-x3n3nnut.js">
    <link rel="prefetch" href="/assets/index.html-2WIsKDLS.js" as="script"><link rel="prefetch" href="/assets/intro.html-aN-Z5FJ0.js" as="script"><link rel="prefetch" href="/assets/index.html-2-TVzRZH.js" as="script"><link rel="prefetch" href="/assets/disable.html-NfiABRyJ.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-2tu9C7Rg.js" as="script"><link rel="prefetch" href="/assets/layout.html-K1XMijuG.js" as="script"><link rel="prefetch" href="/assets/markdown.html-M766fiib.js" as="script"><link rel="prefetch" href="/assets/page.html-fdZRaioO.js" as="script"><link rel="prefetch" href="/assets/cherry.html-BEu7Iemp.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-SInH6nxR.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-Wd8K8_bp.js" as="script"><link rel="prefetch" href="/assets/tomato.html-tFnyg2jm.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼IDç”Ÿæˆå™¨.html-UzxxZ_O8.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html-mwCiA1KS.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼åŸç†.html-MS8znpRd.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼é”.html-awXvBYSL.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•labuladong.html-7kU6j8Z1.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•å›¾è§£.html-U4OQDOmp.js" as="script"><link rel="prefetch" href="/assets/regex.html-OjcPxrkU.js" as="script"><link rel="prefetch" href="/assets/å¤§è¯è®¾è®¡æ¨¡å¼.html-McU-hrYc.js" as="script"><link rel="prefetch" href="/assets/å»¶æ—¶é˜Ÿåˆ—.html-qBmdmuna.js" as="script"><link rel="prefetch" href="/assets/1.html-0CuUCybk.js" as="script"><link rel="prefetch" href="/assets/2.html-BLxlzr7_.js" as="script"><link rel="prefetch" href="/assets/3.html-OnOkO9jh.js" as="script"><link rel="prefetch" href="/assets/4.html-ACoL8goz.js" as="script"><link rel="prefetch" href="/assets/1.html-9HZ6s6sL.js" as="script"><link rel="prefetch" href="/assets/2.html-G5xS20cI.js" as="script"><link rel="prefetch" href="/assets/3.html-toPgYx42.js" as="script"><link rel="prefetch" href="/assets/4.html-KBcotn04.js" as="script"><link rel="prefetch" href="/assets/404.html-KvE_Cm3e.js" as="script"><link rel="prefetch" href="/assets/index.html-0sNQxaQf.js" as="script"><link rel="prefetch" href="/assets/index.html-urTQj0YK.js" as="script"><link rel="prefetch" href="/assets/index.html-Y1rqfq5V.js" as="script"><link rel="prefetch" href="/assets/index.html-wx2SJRRU.js" as="script"><link rel="prefetch" href="/assets/index.html-6HJnvB26.js" as="script"><link rel="prefetch" href="/assets/index.html-4SPqCQea.js" as="script"><link rel="prefetch" href="/assets/index.html-PkTc1YqJ.js" as="script"><link rel="prefetch" href="/assets/index.html-UdgAgtzO.js" as="script"><link rel="prefetch" href="/assets/index.html-AQklAtfn.js" as="script"><link rel="prefetch" href="/assets/index.html-HMNkmBgj.js" as="script"><link rel="prefetch" href="/assets/index.html-y9hzLwAa.js" as="script"><link rel="prefetch" href="/assets/index.html-VMTO-_6Y.js" as="script"><link rel="prefetch" href="/assets/index.html-pvtc5fOn.js" as="script"><link rel="prefetch" href="/assets/index.html-tuGh_-ts.js" as="script"><link rel="prefetch" href="/assets/index.html-XhlHoO1B.js" as="script"><link rel="prefetch" href="/assets/index.html-Am4HtayN.js" as="script"><link rel="prefetch" href="/assets/index.html-TsDB53_7.js" as="script"><link rel="prefetch" href="/assets/index.html-lvWo0wWc.js" as="script"><link rel="prefetch" href="/assets/index.html-l9HqnFKx.js" as="script"><link rel="prefetch" href="/assets/index.html-XBX1lLq2.js" as="script"><link rel="prefetch" href="/assets/index.html-XnCL83Tw.js" as="script"><link rel="prefetch" href="/assets/index.html-1q42_a4Z.js" as="script"><link rel="prefetch" href="/assets/index.html-04fk25DP.js" as="script"><link rel="prefetch" href="/assets/index.html-vezof6zv.js" as="script"><link rel="prefetch" href="/assets/index.html-uk2ZNxff.js" as="script"><link rel="prefetch" href="/assets/index.html-VcDYXQpm.js" as="script"><link rel="prefetch" href="/assets/index.html-1LjdHnIC.js" as="script"><link rel="prefetch" href="/assets/index.html-qFfMV-fU.js" as="script"><link rel="prefetch" href="/assets/index.html-3cj3J5d8.js" as="script"><link rel="prefetch" href="/assets/index.html-TGsEcjxA.js" as="script"><link rel="prefetch" href="/assets/index.html-3UzTpZWX.js" as="script"><link rel="prefetch" href="/assets/index.html-OzcJGRhq.js" as="script"><link rel="prefetch" href="/assets/index.html--ByCqcIb.js" as="script"><link rel="prefetch" href="/assets/index.html-8tWoFC7Z.js" as="script"><link rel="prefetch" href="/assets/intro.html-BYrgxoQy.js" as="script"><link rel="prefetch" href="/assets/index.html-qu1qjMcl.js" as="script"><link rel="prefetch" href="/assets/disable.html-CzPeHRG4.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-6Bn8lW-2.js" as="script"><link rel="prefetch" href="/assets/layout.html-xhA1_8NU.js" as="script"><link rel="prefetch" href="/assets/markdown.html-fVgluYj1.js" as="script"><link rel="prefetch" href="/assets/page.html-fUlhOwun.js" as="script"><link rel="prefetch" href="/assets/cherry.html-ivfXT925.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-w-FDv67I.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-08V67a9l.js" as="script"><link rel="prefetch" href="/assets/tomato.html-2xq793EI.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼IDç”Ÿæˆå™¨.html-4CLQ5bIa.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html-PGX3EUsF.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼åŸç†.html-yV8MLFzU.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼é”.html-DI2Nkvzw.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•labuladong.html-HvOjn3gg.js" as="script"><link rel="prefetch" href="/assets/ç®—æ³•å›¾è§£.html-BxhrpsvT.js" as="script"><link rel="prefetch" href="/assets/regex.html-ZCp96NOs.js" as="script"><link rel="prefetch" href="/assets/å¤§è¯è®¾è®¡æ¨¡å¼.html-g1fNa0ja.js" as="script"><link rel="prefetch" href="/assets/å»¶æ—¶é˜Ÿåˆ—.html-FTDY1cvw.js" as="script"><link rel="prefetch" href="/assets/1.html-ymhtsKHE.js" as="script"><link rel="prefetch" href="/assets/2.html-_CYCSVrQ.js" as="script"><link rel="prefetch" href="/assets/3.html-se3q8vPM.js" as="script"><link rel="prefetch" href="/assets/4.html-D7kOm-MY.js" as="script"><link rel="prefetch" href="/assets/1.html-xauCLT09.js" as="script"><link rel="prefetch" href="/assets/2.html-9HS514w6.js" as="script"><link rel="prefetch" href="/assets/3.html--ln6zu5p.js" as="script"><link rel="prefetch" href="/assets/4.html-o2jlCzQN.js" as="script"><link rel="prefetch" href="/assets/404.html-y8yzZ1yt.js" as="script"><link rel="prefetch" href="/assets/index.html-_ge3xRVW.js" as="script"><link rel="prefetch" href="/assets/index.html-IDhVb1hD.js" as="script"><link rel="prefetch" href="/assets/index.html-XSRzQYWh.js" as="script"><link rel="prefetch" href="/assets/index.html-ylYbhOv3.js" as="script"><link rel="prefetch" href="/assets/index.html-mRClnl9D.js" as="script"><link rel="prefetch" href="/assets/index.html-ZljWxgQM.js" as="script"><link rel="prefetch" href="/assets/index.html-HZcbG8AE.js" as="script"><link rel="prefetch" href="/assets/index.html-QwRqfXPh.js" as="script"><link rel="prefetch" href="/assets/index.html-JNjyxVdm.js" as="script"><link rel="prefetch" href="/assets/index.html-DnNFAtlv.js" as="script"><link rel="prefetch" href="/assets/index.html-nL_t36Ic.js" as="script"><link rel="prefetch" href="/assets/index.html-8uy153fu.js" as="script"><link rel="prefetch" href="/assets/index.html-ORVnriiQ.js" as="script"><link rel="prefetch" href="/assets/index.html-iIuhOw1G.js" as="script"><link rel="prefetch" href="/assets/index.html-TUyNwP4H.js" as="script"><link rel="prefetch" href="/assets/index.html-XXhkIDUy.js" as="script"><link rel="prefetch" href="/assets/index.html-G1KkiDVD.js" as="script"><link rel="prefetch" href="/assets/index.html-tnS3EqYj.js" as="script"><link rel="prefetch" href="/assets/index.html-nasFSu2i.js" as="script"><link rel="prefetch" href="/assets/index.html-rznS1rXY.js" as="script"><link rel="prefetch" href="/assets/index.html-dOx3hpdo.js" as="script"><link rel="prefetch" href="/assets/index.html-j-NUHG68.js" as="script"><link rel="prefetch" href="/assets/index.html-nQCugX1y.js" as="script"><link rel="prefetch" href="/assets/index.html-EQ5Hl_2U.js" as="script"><link rel="prefetch" href="/assets/index.html--biTOFMa.js" as="script"><link rel="prefetch" href="/assets/index.html-cHOn9fs9.js" as="script"><link rel="prefetch" href="/assets/index.html-HCtKhFqK.js" as="script"><link rel="prefetch" href="/assets/index.html-Laca8pZH.js" as="script"><link rel="prefetch" href="/assets/index.html-Yk8HIAgh.js" as="script"><link rel="prefetch" href="/assets/index.html-f8yGQA4L.js" as="script"><link rel="prefetch" href="/assets/index.html-KslgFjCx.js" as="script"><link rel="prefetch" href="/assets/index.html-xkdzS8Iq.js" as="script"><link rel="prefetch" href="/assets/index.html-Qoz2yfpm.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-i2ohwMnJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-S4u-vAqL.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" aria-hidden><!----><span class="vp-site-name hide-in-pad">åšå®¢æ¼”ç¤º</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="é¦–é¡µ" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º" class="vp-link nav-link nav-link" href="/demo/"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="åˆ†å¸ƒå¼" class="vp-link nav-link nav-link" href="/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>åˆ†å¸ƒå¼<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="åšæ–‡"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>åšæ–‡</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>è‹¹æœ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="è‹¹æœ1" class="vp-link nav-link nav-link" href="/posts/apple/1.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>è‹¹æœ1<!----></a></li><li class="dropdown-subitem"><a aria-label="è‹¹æœ2" class="vp-link nav-link nav-link" href="/posts/apple/2.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>è‹¹æœ2<!----></a></li><li class="dropdown-subitem"><a aria-label="è‹¹æœ 3" class="vp-link nav-link nav-link" href="/posts/apple/3.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>è‹¹æœ 3<!----></a></li><li class="dropdown-subitem"><a aria-label="è‹¹æœ 4" class="vp-link nav-link nav-link" href="/posts/apple/4.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>è‹¹æœ 4<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>é¦™è•‰</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="é¦™è•‰ 1" class="vp-link nav-link nav-link" href="/posts/banana/1.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>é¦™è•‰ 1<!----></a></li><li class="dropdown-subitem"><a aria-label="é¦™è•‰ 2" class="vp-link nav-link nav-link" href="/posts/banana/2.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>é¦™è•‰ 2<!----></a></li><li class="dropdown-subitem"><a aria-label="é¦™è•‰ 3" class="vp-link nav-link nav-link" href="/posts/banana/3.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>é¦™è•‰ 3<!----></a></li><li class="dropdown-subitem"><a aria-label="é¦™è•‰ 4" class="vp-link nav-link nav-link" href="/posts/banana/4.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>é¦™è•‰ 4<!----></a></li></ul></li><li class="dropdown-item"><a aria-label="æ¨±æ¡ƒ" class="vp-link nav-link nav-link" href="/posts/cherry.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>æ¨±æ¡ƒ<!----></a></li><li class="dropdown-item"><a aria-label="ç«é¾™æœ" class="vp-link nav-link nav-link" href="/posts/dragonfruit.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç«é¾™æœ<!----></a></li><li class="dropdown-item"><a aria-label="ç•ªèŒ„" class="vp-link nav-link nav-link" href="/posts/tomato.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç•ªèŒ„<!----></a></li><li class="dropdown-item"><a aria-label="è‰è“" class="vp-link nav-link nav-link" href="/posts/strawberry.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>è‰è“<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="V2 æ–‡æ¡£" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>V2 æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="é¦–é¡µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>é¦–é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span><a aria-label="åˆ†å¸ƒå¼" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/%E5%88%86%E5%B8%83%E5%BC%8F/"><!---->åˆ†å¸ƒå¼<!----></a><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="/åˆ†å¸ƒå¼/åˆ†å¸ƒå¼IDç”Ÿæˆå™¨" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8FID%E7%94%9F%E6%88%90%E5%99%A8.html"><!---->/åˆ†å¸ƒå¼/åˆ†å¸ƒå¼IDç”Ÿæˆå™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="åˆ†å¸ƒå¼äº‹åŠ¡" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html"><!---->åˆ†å¸ƒå¼äº‹åŠ¡<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="åˆ†å¸ƒå¼æ¶æ„" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E5%8E%9F%E7%90%86.html"><!---->åˆ†å¸ƒå¼æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="åˆ†å¸ƒå¼é”éœ€è¦å…·å¤‡å“ªäº›æ¡ä»¶" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html"><!---->åˆ†å¸ƒå¼é”éœ€è¦å…·å¤‡å“ªäº›æ¡ä»¶<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ–‡ç« </span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Apple</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Banana</span><span class="vp-arrow end"></span></button><!----></section></li><li><!--[--><a aria-label="æ¨±æ¡ƒ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/posts/cherry.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>æ¨±æ¡ƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ç«é¾™æœ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/posts/dragonfruit.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç«é¾™æœ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="ç•ªèŒ„" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/posts/tomato.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç•ªèŒ„<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="è‰è“" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/posts/strawberry.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>è‰è“<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><!--[--><a aria-label="ä»‹ç»é¡µ" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/intro.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>ä»‹ç»é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="https://plugin-md-enhance.vuejs.press/zh/guide/content/revealjs/demo.html" rel="noopener noreferrer" target="_blank" aria-label="å¹»ç¯ç‰‡" class="nav-link vp-sidebar-link vp-sidebar-page"><span class="font-icon icon fa-fw fa-sm fas fa-person-chalkboard" style=""></span>å¹»ç¯ç‰‡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->æ•°æ®ç»“æ„</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">Mr.Hope</a></span><span property="author" content="Mr.Hope"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-12-17T11:44:33.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 26 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT26M"></span><!----><!----></div><hr></div><!----><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#æ•°æ®ç»“æ„" aria-hidden="true">#</a> æ•°æ®ç»“æ„</h1><p>ç ”ç©¶éæ•°å€¼è®¡ç®—çš„ç¨‹åºè®¾è®¡é—®é¢˜ä¸­çš„æ“ä½œå¯¹è±¡ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»å’Œæ“ä½œç­‰ç›¸å…³é—®é¢˜</p><p>é€»è¾‘ç»“æ„ï¼šé›†åˆç»“æ„ã€çº¿æ€§ç»“æ„ã€æ ‘å½¢ç»“æ„ã€å›¾å½¢ç»“æ„</p><p>ç‰©ç†ç»“æ„ï¼šé¡ºåºå­˜å‚¨ç»“æ„ã€é“¾å¼å­˜å‚¨ç»“æ„</p><p>ç¨‹åºè¿è¡Œæ—¶é—´ï¼Œä¾èµ–äºç®—æ³•å¥½åå’Œé—®é¢˜è¾“å…¥è§„æ¨¡ï¼ˆå¿½ç•¥å› ç´ ï¼šè½¯ä»¶ç¼–è¯‘äº§ç”Ÿçš„ä»£ç è´¨é‡ï¼Œç¡¬ä»¶æœºå™¨æ‰§è¡ŒæŒ‡ä»¤çš„é€Ÿåº¦ï¼‰</p><h5 id="çº¿æ€§ç»“æ„" tabindex="-1"><a class="header-anchor" href="#çº¿æ€§ç»“æ„" aria-hidden="true">#</a> çº¿æ€§ç»“æ„</h5><p>é¡ºåºå­˜å‚¨ï¼šå­˜å–æ•°æ®æ—¶é—´å¤æ‚åº¦o(1)ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(n)ï¼Œé€‚åˆæ•°æ®å­˜å–ï¼Œéœ€è¦é¢„åˆ†é…å­˜å‚¨ç©ºé—´</p><p>é“¾å¼å­˜å‚¨ï¼šå­˜å–æ•°æ®æ—¶é—´å¤æ‚åº¦o(n)ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(1)ï¼Œé€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤</p><h5 id="æ ˆä¸é˜Ÿåˆ—" tabindex="-1"><a class="header-anchor" href="#æ ˆä¸é˜Ÿåˆ—" aria-hidden="true">#</a> æ ˆä¸é˜Ÿåˆ—</h5><h5 id="æ ˆ-é™å®šä»…åœ¨è¡¨å°¾è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„çº¿æ€§ç»“æ„" tabindex="-1"><a class="header-anchor" href="#æ ˆ-é™å®šä»…åœ¨è¡¨å°¾è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„çº¿æ€§ç»“æ„" aria-hidden="true">#</a> æ ˆï¼šé™å®šä»…åœ¨è¡¨å°¾è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„çº¿æ€§ç»“æ„</h5><p>é¡ºåºæ ˆï¼šå¿…é¡»äº‹å…ˆç¡®å®šå­˜å‚¨ç©ºé—´å¤§å°ï¼Œå­˜åœ¨å†…å­˜ç©ºé—´æµªè´¹ï¼Œæ—¶é—´å¤æ‚åº¦o(1)</p><p>é“¾æ ˆï¼šæ¯ä¸ªå…ƒç´ éƒ½æœ‰æŒ‡é’ˆåŸŸï¼Œå¢åŠ äº†å†…å­˜å¼€é”€ï¼Œé•¿åº¦æ— é™åˆ¶ï¼Œæ—¶é—´å¤æ‚åº¦o(1)</p><h5 id="é˜Ÿåˆ—-åªå…è®¸åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥æ“ä½œ-è€Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤æ“ä½œçš„çº¿æ€§ç»“æ„" tabindex="-1"><a class="header-anchor" href="#é˜Ÿåˆ—-åªå…è®¸åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥æ“ä½œ-è€Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤æ“ä½œçš„çº¿æ€§ç»“æ„" aria-hidden="true">#</a> é˜Ÿåˆ—ï¼šåªå…è®¸åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥æ“ä½œï¼Œè€Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤æ“ä½œçš„çº¿æ€§ç»“æ„</h5><p>å¾ªç¯é¡ºåºé˜Ÿåˆ—ï¼šæ—¶é—´å¤æ‚åº¦o(1)ï¼Œäº‹å…ˆç”³è¯·ç©ºé—´ï¼Œä½¿ç”¨æœŸé—´ä¸é‡Šæ”¾</p><p>é“¾é˜Ÿåˆ—ï¼šæ—¶é—´å¤æ‚åº¦o(1)ï¼Œéœ€è¦æŒ‡é’ˆåŸŸï¼Œä¼šäº§ç”Ÿç©ºé—´å¼€é”€</p><h5 id="äºŒå‰æ ‘" tabindex="-1"><a class="header-anchor" href="#äºŒå‰æ ‘" aria-hidden="true">#</a> äºŒå‰æ ‘</h5><p>å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLæ ‘ï¼‰ï¼šäºŒå‰æ’åºæ ‘ï¼Œå·¦å³å­æ ‘é«˜åº¦å·®è‡³å¤šç­‰äº1ï¼ŒæŸ¥æ‰¾ã€æ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(log(n))</p><p>å¤šè·¯æŸ¥æ‰¾æ ‘ï¼ˆBæ ‘ï¼‰ï¼šå­ç»“ç‚¹å¯ä»¥å¤šäºä¸¤ä¸ªï¼Œæ¯ä¸ªç»“ç‚¹å¯å­˜å‚¨å¤šä¸ªå…ƒç´ ï¼ˆé™ä½ç£ç›˜IOï¼‰</p><p>B+æ ‘ï¼šæ‰€æœ‰å¶å­ç»“ç‚¹åŒ…å«å…¨éƒ¨å…³é”®å­—åŠå…¶æŒ‡é’ˆï¼Œä¸”é¡ºåºé“¾æ¥(é€‚åˆèŒƒå›´æŸ¥æ‰¾)</p><p>çº¢é»‘æ ‘ï¼šæ ¹ç»“ç‚¹ä¸ºé»‘è‰²ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²æˆ–çº¢è‰²ï¼Œæ‰€æœ‰å¶å­èŠ‚ç‚¹(Null)éƒ½æ˜¯é»‘è‰²ï¼Œçº¢è‰²èŠ‚ç‚¹å­èŠ‚ç‚¹ä¸€å®šæ˜¯é»‘è‰²ï¼Œä»»ä¸€èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹æ‰€æœ‰è·¯å¾„ä¸Šé»‘è‰²èŠ‚ç‚¹æ•°é‡ç›¸åŒã€‚AVLæ ‘æ˜¯ä¸¥æ ¼å¹³è¡¡äºŒå‰æ ‘ï¼Œè¦æ±‚æ¯ä¸ªèŠ‚ç‚¹å·¦å³å­æ ‘é«˜åº¦å·®ä¸è¶…è¿‡1ï¼ŒæŸ¥æ‰¾æ•ˆç‡ï¼Œå¹³è¡¡è°ƒæ•´æˆæœ¬æ›´é«˜ï¼Œé€‚åˆé¢‘ç¹æŸ¥æ‰¾ï¼›çº¢é»‘æ ‘è¦æ±‚ä»»ä½•ä¸€æ¡è·¯å¾„é•¿åº¦ä¸è¶…è¿‡å…¶ä»–è·¯å¾„é•¿åº¦2å€ï¼Œé€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤ã€‚</p><h5 id="æ•£åˆ—è¡¨-å“ˆå¸Œè¡¨" tabindex="-1"><a class="header-anchor" href="#æ•£åˆ—è¡¨-å“ˆå¸Œè¡¨" aria-hidden="true">#</a> æ•£åˆ—è¡¨ï¼ˆå“ˆå¸Œè¡¨ï¼‰</h5><p>æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦o(1)ï¼Œå½±å“å› ç´ ï¼šæ•£åˆ—å‡½æ•°æ˜¯å¦å‡åŒ€ï¼Œå¤„ç†å†²çªçš„æ–¹æ³•ï¼Œæ•£åˆ—è¡¨çš„è£…å¡«å› å­</p><h5 id="è·³è·ƒè¡¨" tabindex="-1"><a class="header-anchor" href="#è·³è·ƒè¡¨" aria-hidden="true">#</a> è·³è·ƒè¡¨</h5><p>åº•å±‚åŸºäºé“¾è¡¨å®ç°ï¼Œå«æœ‰å¤šå±‚ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„æ¯å±‚éƒ½æœ‰æŒ‡å‘è¡¨å°¾æ–¹å‘æœ€è¿‘ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒæŸ¥è¯¢åŸç†ç±»ä¼¼äºŒåˆ†æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾ã€æ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦o(log(n))ï¼Œç»´æŒç»“æ„å¹³è¡¡æˆæœ¬æ¯”è¾ƒä½</p><h4 id="java" tabindex="-1"><a class="header-anchor" href="#java" aria-hidden="true">#</a> JAVA</h4><h5 id="arraylist-åº•å±‚åŸºäºæ•°ç»„" tabindex="-1"><a class="header-anchor" href="#arraylist-åº•å±‚åŸºäºæ•°ç»„" aria-hidden="true">#</a> ArrayListï¼šåº•å±‚åŸºäºæ•°ç»„</h5><p>ç±»å†…éƒ¨ä½¿ç”¨é»˜è®¤ç¼ºçœæ—¶å¯¹è±¡æ•°ç»„çš„å®¹é‡å¤§å°ï¼Œè‡ªåŠ¨æ‰©å®¹</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DEFAULT_CAPACITY</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">transient</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span><span class="token comment">//ç¼“å­˜æ•°ç»„ï¼Œé€šå¸¸ä¼šé¢„ç•™å®¹é‡</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// overflow-conscious code</span>
    <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> <span class="token constant">MAX_ARRAY_SIZE</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        newCapacity <span class="token operator">=</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// minCapacity is usually close to size, so this is a win:</span>
    elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="linkedlist-å¾ªç¯åŒå‘é“¾è¡¨" tabindex="-1"><a class="header-anchor" href="#linkedlist-å¾ªç¯åŒå‘é“¾è¡¨" aria-hidden="true">#</a> LinkedList: å¾ªç¯åŒå‘é“¾è¡¨</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">transient</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> first<span class="token punctuation">;</span><span class="token comment">//ç»“ç‚¹ä¿å­˜å‰é©±å’Œåç»§çš„å¼•ç”¨</span>
<span class="token keyword">transient</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> last<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">E</span> item<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> prev<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="hashmap-æ•°ç»„-é“¾è¡¨-çº¢é»‘æ ‘" tabindex="-1"><a class="header-anchor" href="#hashmap-æ•°ç»„-é“¾è¡¨-çº¢é»‘æ ‘" aria-hidden="true">#</a> HashMapï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</h5><p>æ•°ç»„é•¿åº¦æ˜¯2çš„næ¬¡å¹‚ï¼ˆæ•£åˆ—åˆ†å¸ƒå‡åŒ€ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> cap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">:</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°*loadFactorï¼Œä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼ˆé™ä½ç¢°æ’å‡ ç‡ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> <span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">&gt;=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span>
                 oldCap <span class="token operator">&gt;=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span>
            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// double threshold</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// initial capacity was placed in threshold</span>
        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>
        newCap <span class="token operator">=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">*</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é“¾è¡¨ä¸çº¢é»‘æ ‘è½¬æ¢ï¼ˆPoisson distributioné“¾è¡¨é•¿åº¦ç­‰äº8çš„æ¦‚ç‡çº¦ä¸º0.00000006ï¼ŒæŸ¥æ‰¾æ€§èƒ½o(n) -&gt; o(log(n))ï¼Œç©ºé—´å¤æ‚åº¦æ¥è¿‘ç¿»å€ï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span><span class="token comment">//è½¬ä¸ºæ ‘</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">UNTREEIFY_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span><span class="token comment">//è½¬ä¸ºé“¾è¡¨</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MIN_TREEIFY_CAPACITY</span> <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span><span class="token comment">//è½¬ä¸ºæ ‘ï¼Œæ•°ç»„æœ€å°å®¹é‡</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•£åˆ—å‡½æ•°ï¼ˆhashå–ä½™è®¡ç®—ç»¼åˆé«˜ä½ä½ä½ï¼Œå‡å°‘hashå†²çªï¼‰</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">//nè¡¨ç¤ºé•¿åº¦</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="copyonwritearraylist-çº¿ç¨‹å®‰å…¨-å¯é‡å…¥é”" tabindex="-1"><a class="header-anchor" href="#copyonwritearraylist-çº¿ç¨‹å®‰å…¨-å¯é‡å…¥é”" aria-hidden="true">#</a> CopyOnWriteArrayList çº¿ç¨‹å®‰å…¨(å¯é‡å…¥é”)</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lock<span class="token punctuation">;</span>
    lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elements <span class="token operator">=</span> <span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> elements<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newElements <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å†™æ—¶å¤åˆ¶ï¼Œå†…å­˜å ç”¨å¤§ï¼Œé€‚åˆå†™å¤šè¯»å°‘çš„å¹¶å‘åœºæ™¯</span>
        newElements<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
        <span class="token function">setArray</span><span class="token punctuation">(</span>newElements<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token comment">//åªèƒ½ä¿è¯æ•°æ®æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸ä¿è¯å®æ—¶ä¸€è‡´æ€§ï¼›å¹¶å‘æ€§æ¯”Vectorå¥½</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="concurrenthashmap-çº¿ç¨‹å®‰å…¨-cas-synchronized" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap-çº¿ç¨‹å®‰å…¨-cas-synchronized" aria-hidden="true">#</a> ConcurrentHashMap çº¿ç¨‹å®‰å…¨(CAS + synchronized)</h5><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Unsafe</span> <span class="token class-name">U</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">transient</span> <span class="token keyword">volatile</span> <span class="token keyword">int</span> sizeCtl<span class="token punctuation">;</span>
<span class="token keyword">transient</span> <span class="token keyword">volatile</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">SIZECTL</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">ABASE</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">ASHIFT</span><span class="token punctuation">;</span>
<span class="token constant">SIZECTL</span> <span class="token operator">=</span> <span class="token class-name">U</span><span class="token punctuation">.</span>objectFieldOffset
    <span class="token punctuation">(</span>k<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">&quot;sizeCtl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">ABASE</span> <span class="token operator">=</span> <span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">arrayBaseOffset</span><span class="token punctuation">(</span>ak<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> scale <span class="token operator">=</span> <span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">arrayIndexScale</span><span class="token punctuation">(</span>ak<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>scale <span class="token operator">&amp;</span> <span class="token punctuation">(</span>scale <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;data type scale not a power of two&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">ASHIFT</span> <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">-</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">numberOfLeadingZeros</span><span class="token punctuation">(</span>scale<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">spread</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab <span class="token operator">=</span> table<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> f<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">,</span> fh<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tab <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            tab <span class="token operator">=</span> <span class="token function">initTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆå§‹åŒ–table</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">=</span> <span class="token function">tabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">casTabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
                         <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>                   <span class="token comment">// no lock when adding to empty bin</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fh <span class="token operator">=</span> f<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">MOVED</span><span class="token punctuation">)</span>
            tab <span class="token operator">=</span> <span class="token function">helpTransfer</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">V</span> oldVal <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//é“¾è¡¨æˆ–çº¢é»‘æ ‘æ·»åŠ èŠ‚ç‚¹ï¼ŒåŠ é”</span>
				<span class="token comment">//...</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">addCount</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> binCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">tabAt</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">getObjectVolatile</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>i <span class="token operator">&lt;&lt;</span> <span class="token constant">ASHIFT</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">ABASE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">boolean</span> <span class="token function">casTabAt</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span>
                                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">compareAndSwapObject</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>i <span class="token operator">&lt;&lt;</span> <span class="token constant">ASHIFT</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">ABASE</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">initTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token keyword">int</span> sc<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> tab<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sc <span class="token operator">=</span> sizeCtl<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//æ•°ç»„åˆå§‹åŒ–æˆ–æ‰©å®¹</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// lost initialization race; just spin</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token constant">SIZECTL</span><span class="token punctuation">,</span> sc<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//JVMä¼šæ ¹æ®å¤„ç†å™¨ç±»å‹ï¼Œä¸ºæ±‡ç¼–æŒ‡ä»¤cmpxhgï¼Œæ¯”è¾ƒå¹¶äº¤æ¢æ“ä½œæ•°ï¼Œå¤šå¤„ç†å™¨åŠ ä¸ŠLockå‰ç¼€ï¼Œå•å¤„ç†å™¨åˆ™å¿½ç•¥ï¼ˆç¡®ä¿å¯¹å†…å­˜è¯»-æ”¹-å†™æ“ä½œåŸå­æ‰§è¡Œï¼Œç¦æ­¢è¯¥æŒ‡ä»¤ä¸å‰åè¯»å†™æŒ‡ä»¤é‡æ’åºï¼ŒæŠŠå†™ç¼“å†²åŒºä¸­çš„æ‰€æœ‰æ•°æ®åˆ·æ–°åˆ°å†…å­˜ï¼‰</span>
            <span class="token comment">//CASç¼ºç‚¹ï¼šå­˜åœ¨ABAé—®é¢˜ï¼Œé‡‡ç”¨ç‰ˆæœ¬å·è§£å†³ï¼›å¾ªç¯æ—¶é—´é•¿ï¼Œå¼€é”€å¤§ï¼›åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> tab<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token punctuation">(</span>sc <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> sc <span class="token operator">:</span> <span class="token constant">DEFAULT_CAPACITY</span><span class="token punctuation">;</span>
                    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> nt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    table <span class="token operator">=</span> tab <span class="token operator">=</span> nt<span class="token punctuation">;</span>
                    sc <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                sizeCtl <span class="token operator">=</span> sc<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> tab<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> MYSQL</h4><h5 id="ç´¢å¼•å®ç°" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•å®ç°" aria-hidden="true">#</a> ç´¢å¼•å®ç°</h5><h5 id="b-treeç´¢å¼•-b-æ ‘" tabindex="-1"><a class="header-anchor" href="#b-treeç´¢å¼•-b-æ ‘" aria-hidden="true">#</a> B-Treeç´¢å¼•(B+æ ‘)</h5><p>å¶å­èŠ‚ç‚¹å­˜æ”¾æ‰€æœ‰ç´¢å¼•å€¼ï¼Œéå¶å­èŠ‚ç‚¹ç”¨äºå¿«é€Ÿå®šä½åŒ…å«ç›®æ ‡å€¼çš„å¶å­èŠ‚ç‚¹ï¼›å¶å­èŠ‚ç‚¹çš„å€¼æœ‰åºï¼›å¶å­èŠ‚ç‚¹ä¹‹é—´ä»¥é“¾è¡¨å…³è”</p><p>InnoDbï¼šå¦‚ä½¿ç”¨èšç°‡ç´¢å¼•ï¼ˆç´¢å¼•å’Œè¡Œæ•°æ®åœ¨ä¸€èµ·å­˜å‚¨ï¼Œä¸€ç§æ•°æ®å­˜å‚¨ç»„ç»‡æ–¹å¼ï¼Œé€šè¿‡ä¸»é”®å®ç°ï¼Œå¦‚æœæ²¡æœ‰ä¸»é”®ä¼šé€‰æ‹©å”¯ä¸€éç©ºç´¢å¼•ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰ï¼Œéšå¼ç”Ÿæˆä¸€ä¸ªä¸»é”®ï¼‰ï¼Œåˆ™å¶å­èŠ‚ç‚¹åŒ…å«è¡Œæ•°æ®ï¼Œç›´æ¥è¿”å›ï¼›å¦‚æœä½¿ç”¨éèšç°‡ç´¢å¼•ï¼ˆæ™®é€šç´¢å¼•ï¼‰ï¼Œåˆ™æ ¹æ®å¶å­èŠ‚ç‚¹çš„ä¸»é”®æŸ¥è¯¢èšç°‡ç´¢å¼•ï¼Œæœ€åè¿”å›æ•°æ®ã€‚</p><p>MyISAM: å¶å­èŠ‚ç‚¹é™¤ç´¢å¼•å€¼åªå­˜å‚¨æŒ‡å‘è¡Œæ•°æ®çš„æŒ‡é’ˆï¼Œæ ¹æ®è¯¥æŒ‡é’ˆä»è¡¨æ–‡ä»¶æŸ¥è¯¢æ•°æ®</p><p>æ”¯æŒèŒƒå›´æŸ¥æ‰¾ï¼Œæ”¯æŒæ’åºï¼Œåˆ†ç»„ï¼Œæ”¯æŒå‰ç¼€åŒ¹é…ï¼›å ç”¨ç©ºé—´è¾ƒå¤§</p><h5 id="hashç´¢å¼•-å“ˆå¸Œè¡¨" tabindex="-1"><a class="header-anchor" href="#hashç´¢å¼•-å“ˆå¸Œè¡¨" aria-hidden="true">#</a> Hashç´¢å¼•(å“ˆå¸Œè¡¨)</h5><p>æŸ¥æ‰¾é€Ÿåº¦æœ€å¿«o(1)ï¼›ä¸æ”¯æŒèŒƒå›´æŸ¥æ‰¾ï¼Œéœ€è¦å¤„ç†hashå†²çªï¼Œå¿…é¡»å…¨å€¼ç²¾ç¡®åŒ¹é…</p><p>ibdataï¼šinnoDBè¡¨å…ƒæ•°æ®ï¼ˆè¡¨ï¼Œåˆ—ï¼Œç´¢å¼•ï¼Œç´¢å¼•åˆ—ï¼‰ï¼Œundo log, change buffer, doublewrite bufferã€‚å¯ç”¨innodb_file_per_tableé€‰é¡¹ï¼Œæ–°åˆ›å»ºè¡¨çš„æ•°å’Œç´¢å¼•å°†å­˜å‚¨åœ¨å•ç‹¬çš„.ibdæ–‡ä»¶(show GLOBAL VARIABLES like &#39;%innodb_file%&#39;)</p><p>ib_logfile: äº‹åŠ¡æ—¥å¿—/redoæ—¥å¿—ï¼Œé‡‡ç”¨é¡ºåºå¾ªç¯å†™å…¥ï¼Œæ¯å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œä¼šè®°å½•å¯¹æ•°æ®æ–‡ä»¶ä¿®æ”¹çš„ç‰©ç†ä½ç½®æˆ–åç§»é‡ã€‚æ–‡ä»¶ä¸ªæ•°ç”±innodb_log_files_in_groupæ§åˆ¶(show GLOBAL VARIABLES like &#39;%innodb_log%&#39;)ã€‚è®°å½•æ‰€æœ‰innodbè¡¨æ•°æ®å˜åŒ–ï¼Œæ­£åœ¨æ‰§è¡Œçš„dmlåŠddlè¯­å¥ï¼Œç³»ç»Ÿå´©æºƒæ•°æ®æ¢å¤</p><h5 id="äº‹åŠ¡å®ç°-redo-undo-log-é”-mvcc" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡å®ç°-redo-undo-log-é”-mvcc" aria-hidden="true">#</a> äº‹åŠ¡å®ç°ï¼ˆredo&amp;undo log, é”, MVCCï¼‰</h5><h5 id="redo-log" tabindex="-1"><a class="header-anchor" href="#redo-log" aria-hidden="true">#</a> redo log</h5><p>redo log buffer &amp; redo logï¼Œåˆ†åˆ«åœ¨å†…å­˜å’Œç£ç›˜ï¼Œç”¨äºæ¢å¤æ•°æ®ï¼Œä¿éšœMySQLå®•æœºæ—¶å·²æäº¤äº‹åŠ¡çš„æŒä¹…åŒ–(mysqlä¿®æ”¹ä¼šå…ˆå­˜åˆ°Buffer Pool(ç¼“å†²æ± ï¼ŒåŒ…å«ç£ç›˜æ•°æ®é¡µçš„æ˜ å°„)ï¼Œè¯»æ•°æ®ä¼šå…ˆä»ç¼“å†²æ± è¯»å–ï¼Œå¦‚æœç¼“å†²æ± æ²¡æœ‰ï¼Œåˆ™ä»ç£ç›˜è¯»å–å†æ”¾å…¥ç¼“å†²æ± ï¼›å†™æ•°æ®ä¼šå…ˆå†™å…¥ç¼“å†²æ± ï¼Œç„¶åç”¨åå°çº¿ç¨‹å®šæœŸåŒæ­¥ç¼“å†²æ± åˆ°ç£ç›˜)</p><p>redo logé¡ºåºå­˜å‚¨ï¼Œç¼“å­˜åŒæ­¥éšæœºæ“ä½œï¼›ç¼“å­˜åŒæ­¥æ˜¯ä»¥æ•°æ®é¡µä¸ºå•ä½ï¼Œæ¯æ¬¡ä¼ è¾“æ•°æ®å¤§å°å¤§äºredo log</p><h5 id="undo-log" tabindex="-1"><a class="header-anchor" href="#undo-log" aria-hidden="true">#</a> undo log</h5><p>è®°å½•äº‹åŠ¡ä¿®æ”¹ä¹‹å‰ç‰ˆæœ¬çš„æ•°æ®ä¿¡æ¯ï¼Œç”¨äºå›æ»šæ•°æ®ï¼Œä¿éšœæœªæäº¤äº‹åŠ¡çš„åŸå­æ€§ã€‚æ•°æ®å˜æ›´æ“ä½œéƒ½ç”Ÿæˆä¸€æ¡undo logï¼Œå¹¶ä¸”å›æ»šæ—¥å¿—å¿…é¡»å…ˆäºæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œäº‹åŠ¡å›æ»šå°±æ˜¯æ ¹æ®å›æ»šæ—¥å¿—åšé€†å‘æ“ä½œ</p><h5 id="è¯»å†™é”-shared-lock-exclusive-lock" tabindex="-1"><a class="header-anchor" href="#è¯»å†™é”-shared-lock-exclusive-lock" aria-hidden="true">#</a> è¯»å†™é”ï¼ˆshared lock / exclusive lockï¼‰</h5><p>InnoDBè¡Œé”ï¼šå…±äº«é”ï¼ˆå…è®¸äº‹åŠ¡è¯»ä¸€è¡Œï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡è·å¾—ç›¸åŒæ•°æ®é›†çš„æ’ä»–é”, select * from table_name where ... lock in share modeï¼‰ï¼Œæ’ä»–é”ï¼ˆå…è®¸è·å¾—æ’ä»–é”çš„äº‹åŠ¡æ›´æ–°æ•°æ®ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å–å¾—ç›¸åŒæ•°æ®é›†çš„è¯»å†™é”, select * from table_name where ... for updateï¼‰ï¼Œå¦‚æœæ²¡æœ‰åŠæ—¶commit/rollbackï¼Œå¯èƒ½ä¼šé€ æˆå…¶ä»–äº‹åŠ¡é•¿æ—¶é—´ç­‰å¾…ï¼Œå½±å“å¹¶å‘æ•ˆç‡</p><p>è¡Œé”å®ç°æ–¹å¼ï¼šé€šè¿‡ç»™ç´¢å¼•ä¸Šçš„ç´¢å¼•é¡¹åŠ é”å®ç°ï¼Œåªæœ‰é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œæ‰ä½¿ç”¨è¡Œé”ï¼Œå¦åˆ™å°†ä½¿ç”¨è¡¨é”</p><p>æ„å‘é”ï¼ˆintention locksï¼Œè¡¨é”ï¼Œä¸ºäº†å…è®¸è¡Œé”å’Œè¡¨é”å…±å­˜ï¼‰ï¼Œæ„å‘å…±äº«é”(IS)ï¼Œæ„å‘æ’ä»–é”(IX)ï¼Œäº‹åŠ¡æ‰“ç®—ç»™æ•°æ®è¡ŒåŠ å…±äº«/æ’ä»–é”ï¼Œåœ¨åŠ é”å‰å¿…é¡»å…ˆå–å¾—è¯¥è¡¨çš„æ„å‘é”</p><p>é—´éš™é”ï¼ˆèŒƒå›´æ£€ç´¢æ•°æ®æ—¶ï¼Œè¯·æ±‚å…±äº«æˆ–æ’ä»–é”æ—¶ï¼Œä¼šç»™ç¬¦åˆæ¡ä»¶çš„å·²æœ‰æ•°æ®è®°å½•ç´¢å¼•é¡¹åŠ é”ï¼ŒèŒƒå›´å†…ä¸å­˜åœ¨çš„è®°å½•ä¹Ÿä¼šåŠ é”ï¼‰ï¼Œé˜»å¡èŒƒå›´é”®å€¼å¹¶å‘æ’å…¥ï¼Œé€ æˆé”ç­‰å¾…</p><h5 id="mvcc-multiversion-concurrency-control-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#mvcc-multiversion-concurrency-control-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶" aria-hidden="true">#</a> MVCCï¼ˆMultiVersion Concurrency Control) å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶</h5><p>é€šè¿‡æ¯è¡Œè®°å½•åé¢ä¿å­˜ä¸¤ä¸ªéšè—åˆ—å®ç°ï¼ˆä¿å­˜è¡Œçš„åˆ›å»ºæ—¶é—´ï¼Œè¿‡æœŸæ—¶é—´ï¼Œå®é™…å­˜å‚¨ç³»ç»Ÿç‰ˆæœ¬å·ï¼Œæ¯å¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œç³»ç»Ÿç‰ˆæœ¬å·ä¼šè‡ªåŠ¨é€’å¢ï¼Œç”¨äºå’ŒæŸ¥è¯¢åˆ°çš„æ¯è¡Œè®°å½•ç‰ˆæœ¬å·æ¯”è¾ƒï¼‰ï¼Œé€šè¿‡æ•°æ®å¤šç‰ˆæœ¬å®ç°ä¸åŠ é”è¯»è¿›è€Œåšåˆ°è¯»å†™å¹¶è¡Œã€‚å®ç°ä¾èµ–ï¼šundo logè®°å½•æŸè¡Œæ•°æ®å¤šä¸ªç‰ˆæœ¬æ•°æ®ï¼Œread viewåˆ¤æ–­å½“å‰ç‰ˆæœ¬æ•°æ®çš„å¯è§æ€§ï¼ˆhttps://dev.mysql.com/doc/refman/8.0/en/innodb-multi-versioning.htmlï¼‰</p><p>READ UNCOMMITTED: è¯»å†™å¹¶è¡Œï¼Œæ€§èƒ½é«˜ï¼›é€ æˆè„è¯»ï¼Œæœªæäº¤äº‹åŠ¡çš„æ•°æ®ä¹Ÿä¼šè¢«è¯»å–åˆ°</p><p>READ COMMITTED: å†™é”ï¼Œè¯»ä¸åŠ é”ï¼›é€ æˆä¸å¯é‡å¤è¯»ï¼ˆäº‹åŠ¡ä¸­ä¼šè¯»å–åˆ°å…¶ä»–äº‹åŠ¡æ–°æäº¤çš„æ•°æ®ï¼Œé€ æˆå¤šæ¬¡è¯»å–ç»“æœä¸ä¸€æ ·ï¼‰ï¼Œå¹»è¯»</p><p>REPEATABLE READ:</p><p>å†™é”ï¼Œè¯»ä¸åŠ é”é‡‡ç”¨MVCCï¼Œè¯»å†™å¹¶è¡Œ</p><p>select: åªæŸ¥æ‰¾ç‰ˆæœ¬å°äºç­‰äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬çš„æ•°æ®è¡Œï¼Œç¡®ä¿åœ¨äº‹åŠ¡å¼€å§‹å‰å·²ç»å­˜åœ¨æˆ–äº‹åŠ¡è‡ªèº«æ’å…¥æˆ–ä¿®æ”¹; è¡Œåˆ é™¤ç‰ˆæœ¬æœªå®šä¹‰æˆ–å¤§äºå½“å‰äº‹åŠ¡ç‰ˆæœ¬å·ï¼Œç¡®ä¿äº‹åŠ¡è¯»å–åˆ°çš„è¡Œï¼Œåœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰æœªè¢«åˆ é™¤</p><p>insert: ä¸ºæ–°æ’å…¥è¡Œä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºè¡Œç‰ˆæœ¬å·</p><p>delete: ä¸ºåˆ é™¤è¡Œä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºè¡Œåˆ é™¤æ ‡è¯†</p><p>update: æ’å…¥ä¸€è¡Œæ–°è®°å½•ä¿å­˜å½“å‰ç³»ç»Ÿç‰ˆæœ¬å·ä½œä¸ºè¡Œç‰ˆæœ¬å·ï¼ŒåŒæ—¶ä¿å­˜ä¸ºåŸæ¥è¡Œä½œä¸ºè¡Œåˆ é™¤æ ‡è¯†</p><p>ä¼šäº§ç”Ÿå¹»è¯»ï¼ˆå¦‚æœäº‹åŠ¡ä¸­æœ‰å…¶ä»–æ–°äº‹åŠ¡æäº¤çš„æ–°æ’å…¥è¡Œï¼ŒæŸ¥è¯¢è®°å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ï¼Œå‡†å¤‡æ’å…¥è¯¥è®°å½•ï¼Œä½†æ˜¯æ‰§è¡Œå‘ç°æ­¤è®°å½•å·²å­˜åœ¨ï¼Œæ— æ³•æ’å…¥ï¼‰</p><p>SERIALIZABLE: åŠ é”è¯»ï¼Œè¯»å†™ä¸²è¡Œï¼Œæ€§èƒ½ä½</p><h4 id="redis" tabindex="-1"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> Redis</h4><h5 id="redisobject-ç»“æ„" tabindex="-1"><a class="header-anchor" href="#redisobject-ç»“æ„" aria-hidden="true">#</a> redisObject ç»“æ„</h5><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">redisObject</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç±»å‹(string,list,hash,set,zset)</span>
    <span class="token keyword">unsigned</span> type<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token comment">// ç¼–ç (é€šè¿‡OBJECT ENCODING keyæŸ¥çœ‹, int:longç±»å‹æ•´æ•°ï¼Œembstr:embstrç¼–ç çš„ç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼Œraw:ç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼Œhashtable:å­—å…¸ï¼Œlinkedlist:åŒç«¯é“¾è¡¨ï¼Œziplist:å‹ç¼©åˆ—è¡¨ï¼Œintset:æ•´æ•°é›†åˆï¼Œskiplistï¼šè·³è·ƒè¡¨å’Œå­—å…¸)</span>
    <span class="token keyword">unsigned</span> encoding<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token comment">// æŒ‡å‘åº•å±‚å®ç°æ•°æ®ç»“æ„çš„æŒ‡é’ˆ</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span> robj<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ç®€å•åŠ¨æ€å­—ç¬¦ä¸²-simple-dynamic-string-sds" tabindex="-1"><a class="header-anchor" href="#ç®€å•åŠ¨æ€å­—ç¬¦ä¸²-simple-dynamic-string-sds" aria-hidden="true">#</a> ç®€å•åŠ¨æ€å­—ç¬¦ä¸²(simple dynamic string, SDS)</h5><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">//ç®€å•åŠ¨æ€å­—ç¬¦ä¸²(simple dynamic string, SDS)</span>
<span class="token comment">//è·å–å­—ç¬¦ä¸²é•¿åº¦å¤æ‚åº¦o(1); ä¿®æ”¹å­—ç¬¦ä¸²æ—¶ï¼Œä¼šæ£€æŸ¥å†…å­˜ç©ºé—´å†è¿›è¡Œå­—ç¬¦ä¸²ä¿®æ”¹ï¼Œæœç»ç¼“å†²åŒºæº¢å‡ºï¼›é‡‡ç”¨ç©ºé—´é¢„åˆ†é…å’Œæƒ°æ€§é‡Šæ”¾ç©ºé—´</span>
<span class="token keyword">struct</span> <span class="token class-name">sdshdr</span> <span class="token punctuation">{</span>
    <span class="token comment">// buf ä¸­å·²å ç”¨ç©ºé—´çš„é•¿åº¦</span>
    <span class="token keyword">int</span> len<span class="token punctuation">;</span>
    <span class="token comment">// buf ä¸­å‰©ä½™å¯ç”¨ç©ºé—´çš„é•¿åº¦</span>
    <span class="token keyword">int</span> free<span class="token punctuation">;</span>
    <span class="token comment">// æ•°æ®ç©ºé—´ï¼Œä»¥&#39;\0&#39;ä½œä¸ºç»“æŸæ ‡è¯†ç¬¦</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//å­—ç¬¦ä¸²å¯¹è±¡ï¼šintç¼–ç ï¼Œä¿å­˜æ•´æ•°å€¼ï¼›rawç¼–ç ï¼Œå­—ç¬¦ä¸²ä¿å­˜å¤§äº32å­—èŠ‚å­—ç¬¦ä¸²ï¼Œå†…å­˜åˆ†é…æ¬¡æ•°ä¸¤æ¬¡ï¼›embstrç¼–ç ï¼Œå­—ç¬¦ä¸²ä¿å­˜å°äºç­‰äº32å­—èŠ‚å­—ç¬¦ä¸²ï¼Œå†…å­˜åˆ†é…åªéœ€ä¸€æ¬¡</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="å‹ç¼©åˆ—è¡¨-ziplist" tabindex="-1"><a class="header-anchor" href="#å‹ç¼©åˆ—è¡¨-ziplist" aria-hidden="true">#</a> å‹ç¼©åˆ—è¡¨(ziplist)</h5><p>ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„è¿ç»­å†…å­˜å—ç»„æˆçš„é¡ºåºå­˜å‚¨ç»“æ„ï¼Œä¸åŒäºæ•°ç»„ï¼Œä¸ºèŠ‚çœå†…å­˜æ¯ä¸ªå…ƒç´ æ‰€å å†…å­˜å¤§å°å¯ä»¥ä¸åŒã€‚å†…å­˜å ç”¨å°‘ï¼Œå®¹æ˜“åŠ è½½åˆ°CPUç¼“å­˜ï¼Œç»“æ„ç´§å‡‘ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦o(n)ï¼›è¿é”æ›´æ–°</p><p>zlbytes: ziplistçš„é•¿åº¦ï¼ˆå•ä½: å­—èŠ‚)ï¼Œæ˜¯ä¸€ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</p><p>zltail: ziplistæœ€åä¸€ä¸ªèŠ‚ç‚¹çš„åç§»é‡ï¼Œåå‘éå†ziplistæˆ–è€…popå°¾éƒ¨èŠ‚ç‚¹çš„æ—¶å€™æœ‰ç”¨ã€‚</p><p>zllen: ziplistçš„èŠ‚ç‚¹ï¼ˆentryï¼‰ä¸ªæ•°</p><p>entry: èŠ‚ç‚¹(prevlengh: è®°å½•ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦ï¼Œä¸ºäº†æ–¹ä¾¿åå‘éå†ziplist; encoding: å½“å‰èŠ‚ç‚¹çš„ç¼–ç è§„åˆ™; data: å½“å‰èŠ‚ç‚¹çš„å€¼ï¼Œå¯ä»¥æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²)</p><p>zlend: å€¼ä¸º0xFFï¼Œç”¨äºæ ‡è®°ziplistçš„ç»“å°¾</p><h5 id="é“¾è¡¨" tabindex="-1"><a class="header-anchor" href="#é“¾è¡¨" aria-hidden="true">#</a> é“¾è¡¨</h5><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">list</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¡¨å¤´èŠ‚ç‚¹</span>
    listNode <span class="token operator">*</span> head<span class="token punctuation">;</span>
    <span class="token comment">// è¡¨å°¾èŠ‚ç‚¹</span>
    listNode <span class="token operator">*</span> tail<span class="token punctuation">;</span>
    <span class="token comment">// é“¾è¡¨æ‰€åŒ…å«çš„èŠ‚ç‚¹æ•°é‡</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> len<span class="token punctuation">;</span>
    <span class="token comment">// èŠ‚ç‚¹å€¼å¤åˆ¶å‡½æ•°</span>
    <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>dup<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// èŠ‚ç‚¹å€¼é‡Šæ”¾å‡½æ•°</span>
    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>free<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// èŠ‚ç‚¹å€¼å¯¹æ¯”å‡½æ•°</span>
    <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>match<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> list<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‰ç½®èŠ‚ç‚¹</span>
    <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token operator">*</span> prev<span class="token punctuation">;</span>
    <span class="token comment">// åç½®èŠ‚ç‚¹</span>
    <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token operator">*</span> next<span class="token punctuation">;</span>
    <span class="token comment">// èŠ‚ç‚¹çš„å€¼</span>
    <span class="token keyword">void</span> <span class="token operator">*</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>listNode<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="å­—å…¸" tabindex="-1"><a class="header-anchor" href="#å­—å…¸" aria-hidden="true">#</a> å­—å…¸</h5><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">//dict.h</span>
<span class="token comment">//å­—å…¸ æˆ–ç§°ç¬¦å·è¡¨symbol table, å…³è”æ•°ç»„associative array, æ˜ å°„map</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dict</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç±»å‹ç‰¹å®šå‡½æ•°</span>
    dictType <span class="token operator">*</span>type<span class="token punctuation">;</span>
    <span class="token comment">// ç§æœ‰æ•°æ®</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">;</span>
    <span class="token comment">// å“ˆå¸Œè¡¨ï¼Œrehashæ“ä½œï¼Œä¸ºht[1]åˆ†é…ç©ºé—´ï¼Œé‡æ–°è®¡ç®—ht[0]å“ˆå¸Œå€¼ï¼Œæ”¾åˆ°ht[1]ï¼Œè¿ç§»å®Œæˆåï¼Œå°†ht[1]è®¾ç½®ä¸ºht[0]ï¼Œé‡Šæ”¾ht[0]ï¼Œå¹¶åˆ›å»ºç©ºç™½ht[1],ä¸ºä¸‹æ¬¡rehashåšå‡†å¤‡</span>
    dictht ht<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// rehashç´¢å¼•ï¼Œåˆ†å¤šæ¬¡æ¸è¿›å¼rehashï¼Œå®Œæˆårehashidxå¢åŠ 1ï¼Œè¿ç§»å®Œæˆrehashidxè®¾ä¸º-1ï¼Œæ ‡è¯†rehashå®Œæˆã€‚æœŸé—´ï¼ŒæŸ¥æ‰¾å…ˆæ‰¾ht[0]ï¼Œå†æ‰¾ht[1]ï¼›æ·»åŠ æ“ä½œä¸€å¾‹æ·»åŠ åˆ°ht[1]</span>
    <span class="token keyword">int</span> rehashidx<span class="token punctuation">;</span> <span class="token comment">/* rehashing not in progress if rehashidx == -1 */</span>
    <span class="token keyword">int</span> iterators<span class="token punctuation">;</span> <span class="token comment">/* number of iterators currently running */</span>
<span class="token punctuation">}</span> dict<span class="token punctuation">;</span>
<span class="token comment">//å­—å…¸å†…éƒ¨hashtable</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictht</span> <span class="token punctuation">{</span>
    <span class="token comment">// å“ˆå¸Œè¡¨æ•°ç»„</span>
    dictEntry <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span>
    <span class="token comment">// å“ˆå¸Œè¡¨å¤§å°</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> size<span class="token punctuation">;</span>
    <span class="token comment">// å“ˆå¸Œè¡¨å¤§å°æ©ç ï¼Œç”¨äºè®¡ç®—ç´¢å¼•å€¼ï¼Œsize-1</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sizemask<span class="token punctuation">;</span>
    <span class="token comment">// å·²æœ‰èŠ‚ç‚¹æ•°é‡</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> used<span class="token punctuation">;</span>
<span class="token punctuation">}</span> dictht<span class="token punctuation">;</span>
<span class="token comment">//hashtableèŠ‚ç‚¹</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token punctuation">{</span>
    <span class="token comment">// key</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">;</span>
    <span class="token comment">// å€¼</span>
    <span class="token keyword">union</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token operator">*</span>val<span class="token punctuation">;</span>
        <span class="token class-name">uint64_t</span> u64<span class="token punctuation">;</span>
        <span class="token class-name">int64_t</span> s64<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> v<span class="token punctuation">;</span>
    <span class="token comment">// æŒ‡å‘ä¸‹ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹ï¼Œå½¢æˆé“¾è¡¨</span>
    <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>
<span class="token punctuation">}</span> dictEntry<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="è·³è·ƒè¡¨-1" tabindex="-1"><a class="header-anchor" href="#è·³è·ƒè¡¨-1" aria-hidden="true">#</a> è·³è·ƒè¡¨</h5><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">//æ¯ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªæŒ‡å‘å…¶ä»–èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»è€Œå¿«é€Ÿè®¿é—®èŠ‚ç‚¹</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplist</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¡¨å¤´èŠ‚ç‚¹å’Œè¡¨å°¾èŠ‚ç‚¹</span>
    structz skiplistNode <span class="token operator">*</span>header<span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">;</span>
    <span class="token comment">// è¡¨ä¸­èŠ‚ç‚¹çš„æ•°é‡</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> length<span class="token punctuation">;</span>
    <span class="token comment">// è¡¨ä¸­å±‚æ•°æœ€å¤§çš„èŠ‚ç‚¹çš„å±‚æ•°</span>
    <span class="token keyword">int</span> level<span class="token punctuation">;</span>
<span class="token punctuation">}</span> zskiplist<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token punctuation">{</span>
    <span class="token comment">// å±‚</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistLevel</span> <span class="token punctuation">{</span>
        <span class="token comment">// å‰è¿›æŒ‡é’ˆ</span>
        <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>forward<span class="token punctuation">;</span>
        <span class="token comment">// è·¨åº¦</span>
        <span class="token keyword">unsigned</span> <span class="token keyword">int</span> span<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> level<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// åé€€æŒ‡é’ˆ</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>backward<span class="token punctuation">;</span>
    <span class="token comment">// åˆ†å€¼</span>
    <span class="token keyword">double</span> score<span class="token punctuation">;</span>
    <span class="token comment">// æˆå‘˜å¯¹è±¡</span>
    robj <span class="token operator">*</span>obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span> zskiplistNode<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="æ•´æ•°é›†åˆ" tabindex="-1"><a class="header-anchor" href="#æ•´æ•°é›†åˆ" aria-hidden="true">#</a> æ•´æ•°é›†åˆ</h5><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">//å½“é›†åˆåªåŒ…å«æ•´æ•°å…ƒç´ ï¼Œå¹¶ä¸”å…ƒç´ ä¸ªæ•°ä¸å¤šæ—¶ï¼Œä½œä¸ºé›†åˆé”®çš„åº•å±‚å®ç°ï¼Œå¯ä»¥ä¿å­˜int16_t,int32_t,int64_tæ•´æ•°å€¼ï¼Œä¸ä¼šå‡ºç°é‡å¤å…ƒç´ </span>
<span class="token comment">//å‡çº§æ“ä½œï¼šåŸæ¥ä¿å­˜çš„æ˜¯å°ç±»å‹(å¦‚int16_t)çš„æ•´æ•°ï¼Œå½“æ’å…¥æ¯”å…¶ç±»å‹å¤§(å¦‚int64_t)çš„æ•´æ•°ï¼Œä¼šæŠŠé›†åˆé‡Œçš„å…ƒç´ æ•°æ®ç±»å‹è½¬æ¢æˆå¤§çš„ç±»å‹ï¼ŒèŠ‚çº¦å†…å­˜ï¼Œä½†ä¸æ”¯æŒé™çº§æ“ä½œ</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">intset</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç¼–ç æ–¹å¼</span>
    <span class="token class-name">uint32_t</span> encoding<span class="token punctuation">;</span>
    <span class="token comment">// é›†åˆåŒ…å«çš„å…ƒç´ æ•°é‡</span>
    <span class="token class-name">uint32_t</span> length<span class="token punctuation">;</span>
    <span class="token comment">// ä¿å­˜å…ƒç´ çš„æ•°ç»„</span>
    <span class="token class-name">int8_t</span> contents<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> intset<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="åˆ—è¡¨å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#åˆ—è¡¨å¯¹è±¡" aria-hidden="true">#</a> åˆ—è¡¨å¯¹è±¡</h5><p>ziplistç¼–ç ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¿å­˜ä¸€ä¸ªåˆ—è¡¨å…ƒç´ ã€‚æ»¡è¶³æ‰€æœ‰å­—ç¬¦ä¸²é•¿åº¦éƒ½å°äº64å­—èŠ‚ï¼Œå…ƒç´ æ•°é‡å°äº512</p><p>linkedlistç¼–ç ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ä¿å­˜ä¸€ä¸ªåˆ—è¡¨å…ƒç´ </p><h5 id="å“ˆå¸Œå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#å“ˆå¸Œå¯¹è±¡" aria-hidden="true">#</a> å“ˆå¸Œå¯¹è±¡</h5><p>ziplistç¼–ç ï¼škey-valueé”®å€¼å¯¹ä»¥ç´§å¯†ç›¸è¿çš„æ–¹å¼æ”¾å…¥ï¼Œæ€»æ˜¯å‘è¡¨å°¾æ·»åŠ ã€‚æ»¡è¶³æ‰€æœ‰é”®å€¼å­—ç¬¦ä¸²é•¿åº¦éƒ½å°äº64å­—èŠ‚ï¼Œé”®å€¼å¯¹æ•°é‡å°äº512ä¸ª</p><p>hashtableç¼–ç ï¼šå­—å…¸å®ç°ï¼Œå­—å…¸çš„é”®å€¼éƒ½æ˜¯å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå­—å…¸çš„é”®ä¿å­˜keyï¼Œå­—å…¸å€¼ä¿å­˜value</p><h5 id="é›†åˆå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#é›†åˆå¯¹è±¡" aria-hidden="true">#</a> é›†åˆå¯¹è±¡</h5><p>intsetç¼–ç ï¼šæ‰€æœ‰å…ƒç´ éƒ½ä¿å­˜åœ¨æ•´æ•°é›†åˆã€‚æ»¡è¶³æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æ•´æ•°å€¼ï¼Œå…ƒç´ ä¸ªæ•°å°äºç­‰äº512ä¸ª</p><p>hashtableç¼–ç ï¼šå­—å…¸æ¯ä¸ªé”®éƒ½æ˜¯å­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¿å­˜é›†åˆå…ƒç´ ï¼Œå­—å…¸å€¼éƒ½æ˜¯NULL</p><h5 id="æœ‰åºé›†åˆå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#æœ‰åºé›†åˆå¯¹è±¡" aria-hidden="true">#</a> æœ‰åºé›†åˆå¯¹è±¡</h5><p>ziplistç¼–ç ï¼šç±»ä¼¼å“ˆå¸Œå¯¹è±¡ï¼Œä¸¤ä¸ªç´§å¯†ç›¸è¿çš„å‹ç¼©åˆ—è¡¨èŠ‚ç‚¹ï¼Œç¬¬ä¸€ä¸ªä¿å­˜å…ƒç´ çš„æˆå‘˜ï¼Œç¬¬äºŒä¸ªä¿å­˜å…ƒç´ çš„åˆ†å€¼ï¼Œåˆ†å€¼å°çš„é è¿‘è¡¨å¤´ï¼Œå¤§çš„é è¿‘è¡¨å°¾ã€‚æ»¡è¶³æ‰€æœ‰å…ƒç´ å°äº64å­—èŠ‚ï¼Œå…ƒç´ ä¸ªæ•°å°äº128ä¸ª</p><p>skiplistç¼–ç ï¼šåŒæ—¶ä½¿ç”¨è·³è·ƒè¡¨å’Œå­—å…¸ï¼Œè·³è·ƒè¡¨èŠ‚ç‚¹ä¿å­˜é›†åˆå…ƒç´ ï¼ŒæŒ‰åˆ†å€¼ä»å°åˆ°å¤§æ’åˆ—ï¼ŒèŠ‚ç‚¹objectå±æ€§ä¿å­˜å…ƒç´ æˆå‘˜ï¼Œscoreå±æ€§ä¿å­˜åˆ†å€¼ï¼›å­—å…¸æ¯ä¸ªé”®å€¼å¯¹ä¿å­˜é›†åˆå…ƒç´ ï¼Œå­—å…¸é”®ä¿å­˜å…ƒç´ æˆå‘˜ï¼Œå­—å…¸å€¼ä¿å­˜åˆ†å€¼ã€‚è·³è·ƒè¡¨æœ‰åºï¼Œä½†æŸ¥è¯¢åˆ†å€¼å¤æ‚åº¦o(logn)ï¼Œå­—å…¸æŸ¥è¯¢åˆ†å€¼å¤æ‚åº¦o(1)ï¼Œä½†æ˜¯æ— åºï¼›é‡‡ç”¨ä¸¤ç§ç»“æ„ä½†æ˜¯é›†åˆå…ƒç´ æˆå‘˜å’Œåˆ†å€¼æ˜¯å…±äº«çš„ï¼Œé€šè¿‡æŒ‡é’ˆæŒ‡å‘åŒä¸€åœ°å€</p><h4 id="elasticsearch" tabindex="-1"><a class="header-anchor" href="#elasticsearch" aria-hidden="true">#</a> ElasticSearch</h4><h5 id="ç´¢å¼•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ç»“æ„" aria-hidden="true">#</a> ç´¢å¼•ç»“æ„</h5><p>åˆ†å¸ƒå¼å¯æ‰©å±•ï¼šç”¨æˆ·æŸ¥è¯¢åœ¨indexä¸Šå®Œæˆï¼Œindexç”±shardç»„æˆã€‚shardæ˜¯æ•°æ®å­˜å‚¨çš„æœ€å°å•å…ƒï¼Œå¯¹åº”luceneçš„libraryã€‚</p><p>Elasticsearchä¸ºæ¯ä¸ªfieldå»ºç«‹å€’æ’ç´¢å¼•termï¼Œå¯¹åº”ç¬¦åˆçš„æ–‡æ¡£idå­˜å‚¨åœ¨Posting Listï¼ˆè¦æ±‚æœ‰åºï¼‰ã€‚å°†ç£ç›˜é‡Œçš„ä¸œè¥¿å°½é‡æ¬è¿›å†…å­˜ï¼Œå‡å°‘ç£ç›˜éšæœºè¯»å–æ¬¡æ•°ï¼Œå‹ç¼©å†…å­˜ä½¿ç”¨ç©ºé—´</p><p>é€šè¿‡termçš„å‰ç¼€ä¸Term Dictionaryçš„blockä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œç»“åˆFST(æœ‰ç©·çŠ¶æ€è½¬æ¢å™¨ï¼ŒFinite State Transducersï¼Œç©ºé—´å ç”¨å°ï¼Œæ­¤å•å•è¯é‡å¤åˆ©ç”¨ï¼Œå‹ç¼©å­˜å‚¨ç©ºé—´ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«o(len(str)))å‹ç¼©ï¼Œå°†term indexç¼“å­˜åˆ°å†…å­˜ï¼Œä»term indexæŸ¥åˆ°å¯¹åº”term dictionaryçš„blockä½ç½®ï¼Œå†åœ¨ç£ç›˜ä¸Šæ‰¾termï¼Œå‡å°‘ç£ç›˜éšæœºè¯»æ¬¡æ•°</p><p>Posting listå‹ç¼©ï¼ˆFrame Of Referenceï¼Œå¢é‡ç¼–ç å‹ç¼©ï¼Œå°†å¤§æ•°å˜å°æ•°ï¼Œä»…å­˜å‚¨å¢é‡å€¼ï¼ŒæŒ‰bitæ’é˜Ÿï¼ˆå¤´éƒ¨å­˜å‚¨Bits per value: 1 byteï¼Œå…·ä½“æŒ‰å®é™…æ‰€éœ€bitså¤§å°å­˜å‚¨ï¼‰ï¼Œæœ€åæŒ‰å­—èŠ‚å­˜å‚¨ï¼‰</p><p>Roaring bitmapsï¼Œå°†posting listæŒ‰ç…§65535ï¼ˆ2^16-1ï¼Œ2ä¸ªå­—èŠ‚è¡¨ç¤ºæœ€å¤§æ•°ï¼Œshortå­˜å‚¨å•ä½ï¼‰ä¸ºç•Œé™åˆ†å—ï¼Œä»¥&lt;å•†ï¼Œä½™æ•°&gt;ç»„åˆè¡¨ç¤ºæ¯ä¸€ç»„idï¼Œå¦‚æœå—åŒ…å«å¤§äº4096çš„å€¼ï¼Œé‡‡ç”¨bit setï¼Œå¦åˆ™ç”¨2ä¸ªå­—èŠ‚çš„æ•°ç»„</p><p>è”åˆç´¢å¼•ï¼šè·³è·ƒè¡¨ï¼ˆå¯¹æœ€çŸ­posting listçš„æ¯ä¸ªidï¼Œåœ¨å¦å¤–çš„posting listä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ï¼Œæœ€åå¾—åˆ°äº¤é›†çš„ç»“æœï¼‰ï¼›bitsetï¼ˆç›´æ¥æŒ‰ä½ä¸ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯æœ€åçš„äº¤é›†ï¼‰</p><h5 id="luceneå†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#luceneå†…éƒ¨ç»“æ„" aria-hidden="true">#</a> luceneå†…éƒ¨ç»“æ„</h5><p>luceneå†…éƒ¨æ•°æ®ç”±segmentç»„æˆï¼Œå†™å…¥çš„æ•°æ®å…ˆå†™åœ¨å†…å­˜ä¸­ï¼Œç»è¿‡refreshé—´éš”å°†è¯¥æ—¶æ®µçš„å…¨éƒ¨æ•°æ®refreshæˆä¸€ä¸ªsegmentï¼Œç„¶åmergeæˆæ›´å¤§çš„segmentã€‚æŸ¥è¯¢æ—¶ä¼šéå†æ¯ä¸ªsegmentï¼Œç”±äºåœ¨å†…å­˜ä¸­å®Œæˆå†™å…¥æ•ˆç‡é«˜ï¼Œä½†å­˜åœ¨ä¸¢å¤±æ•°æ®çš„é£é™©ï¼ŒElasticsearchå®ç°äº†translogï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±</p><p>doc: luceneä¸­ä¸€æ¡è®°å½•</p><p>field: è®°å½•ä¸­çš„å­—æ®µæ¦‚å¿µ</p><p>term: ç´¢å¼•æœ€å°å•ä½ï¼Œå¦‚æœfieldå¯¹åº”å†…å®¹æ˜¯å…¨æ–‡æ£€ç´¢ç±»å‹ï¼Œä¼šè¿›è¡Œåˆ†è¯ï¼Œç»“æœç”±termç»„æˆã€‚ä¸åˆ†è¯ï¼Œå­—æ®µå†…å®¹æ˜¯ä¸€ä¸ªterm</p><p>å€’æ’ç´¢å¼•(inverted index): å®ç°termåˆ°doc listçš„æ˜ å°„</p><p>æ­£æ’æ•°æ®ï¼šåŸå§‹æ•°æ®(doc list)</p><p>docvalues: åˆ—å¼å­˜å‚¨çš„åç§°ï¼Œç”¨ä½œåˆ†æå’Œæ’åº</p><h5 id="luceneæ–‡ä»¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#luceneæ–‡ä»¶å†…å®¹" aria-hidden="true">#</a> luceneæ–‡ä»¶å†…å®¹</h5><p>ç”±å¾ˆå¤šsegmentæ–‡ä»¶ç»„æˆï¼Œæ¯ä¸ªsegmentåŒ…å«å¦‚ä¸‹æ–‡ä»¶</p><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Extension</th><th style="text-align:left;">Brief Description</th></tr></thead><tbody><tr><td style="text-align:left;">Segment Info</td><td style="text-align:left;">.si</td><td style="text-align:left;">segmentçš„å…ƒæ•°æ®æ–‡ä»¶ï¼Œè®°å½•segmentæ–‡æ¡£æ•°é‡ï¼Œå¯¹åº”æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td style="text-align:left;">Compound File</td><td style="text-align:left;">.cfs, .cfe</td><td style="text-align:left;">ä¸€ä¸ªsegmentåŒ…å«äº†å¦‚ä¸‹è¡¨çš„å„ä¸ªæ–‡ä»¶ï¼Œä¸ºå‡å°‘æ‰“å¼€æ–‡ä»¶çš„æ•°é‡ï¼Œåœ¨segmentå°çš„æ—¶å€™ï¼Œsegmentçš„æ‰€æœ‰æ–‡ä»¶å†…å®¹éƒ½ä¿å­˜åœ¨cfsæ–‡ä»¶ä¸­ï¼Œcfeæ–‡ä»¶ä¿å­˜äº†luceneå„æ–‡ä»¶åœ¨cfsæ–‡ä»¶çš„ä½ç½®ä¿¡æ¯</td></tr><tr><td style="text-align:left;">Fields</td><td style="text-align:left;">.fnm</td><td style="text-align:left;">ä¿å­˜äº†fieldsçš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬fieldæ•°é‡ï¼Œç±»å‹ï¼Œæ˜¯å¦å­˜å‚¨ï¼Œç´¢å¼•ï¼Œåˆ†è¯ï¼Œåˆ—å­˜</td></tr><tr><td style="text-align:left;">Field Index</td><td style="text-align:left;">.fdx</td><td style="text-align:left;">æ­£æ’å­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯</td></tr><tr><td style="text-align:left;">Field Data</td><td style="text-align:left;">.fdt</td><td style="text-align:left;">å­˜å‚¨äº†æ­£æ’å­˜å‚¨æ•°æ®ï¼Œå†™å…¥çš„åŸæ–‡å­˜å‚¨åœ¨è¿™</td></tr><tr><td style="text-align:left;">Term Dictionary</td><td style="text-align:left;">.tim</td><td style="text-align:left;">å€’æ’ç´¢å¼•çš„å…ƒæ•°æ®ä¿¡æ¯</td></tr><tr><td style="text-align:left;">Term Index</td><td style="text-align:left;">.tip</td><td style="text-align:left;">å€’æ’ç´¢å¼•æ–‡ä»¶ï¼Œå­˜å‚¨äº†æ‰€æœ‰çš„å€’æ’ç´¢å¼•æ•°æ®ï¼Œå€’æ’ç´¢å¼•å®ç°ä¸ºFST treeï¼Œå†…å­˜ç©ºé—´å ç”¨ä½</td></tr><tr><td style="text-align:left;">Frequencies</td><td style="text-align:left;">.doc</td><td style="text-align:left;">ä¿å­˜äº†æ¯ä¸ªtermçš„doc idåˆ—è¡¨å’Œtermåœ¨docä¸­çš„è¯é¢‘</td></tr><tr><td style="text-align:left;">Positions</td><td style="text-align:left;">.pos</td><td style="text-align:left;">Stores position information about where a term occurs in the index å…¨æ–‡ç´¢å¼•çš„å­—æ®µï¼Œä¼šæœ‰è¯¥æ–‡ä»¶ï¼Œä¿å­˜äº†termåœ¨docä¸­çš„ä½ç½®</td></tr><tr><td style="text-align:left;">Payloads</td><td style="text-align:left;">.pay</td><td style="text-align:left;">Stores additional per-position metadata information such as character offsets and user payloads å…¨æ–‡ç´¢å¼•çš„å­—æ®µï¼Œä½¿ç”¨äº†ä¸€äº›åƒpayloadsçš„é«˜çº§ç‰¹æ€§ä¼šæœ‰è¯¥æ–‡ä»¶ï¼Œä¿å­˜äº†termåœ¨docä¸­çš„ä¸€äº›é«˜çº§ç‰¹æ€§</td></tr><tr><td style="text-align:left;">Norms</td><td style="text-align:left;">.nvd, .nvm</td><td style="text-align:left;">æ–‡ä»¶ä¿å­˜ç´¢å¼•å­—æ®µåŠ æƒæ•°æ®</td></tr><tr><td style="text-align:left;">Per-Document Values</td><td style="text-align:left;">.dvd, .dvm</td><td style="text-align:left;">luceneçš„docvaluesæ–‡ä»¶ï¼Œå³æ•°æ®çš„åˆ—å¼å­˜å‚¨ï¼Œç”¨ä½œèšåˆå’Œæ’åº</td></tr><tr><td style="text-align:left;">Term Vector Data</td><td style="text-align:left;">.tvx, .tvd, .tvf</td><td style="text-align:left;">Stores offset into the document data file ä¿å­˜ç´¢å¼•å­—æ®µçš„çŸ¢é‡ä¿¡æ¯ï¼Œç”¨åœ¨å¯¹termè¿›è¡Œé«˜äº®ï¼Œè®¡ç®—æ–‡æœ¬ç›¸å…³æ€§ä¸­ä½¿ç”¨</td></tr><tr><td style="text-align:left;">Live Documents</td><td style="text-align:left;">.liv</td><td style="text-align:left;">è®°å½•äº†segmentä¸­åˆ é™¤çš„doc</td></tr></tbody></table><h5 id="è¯»å†™æ•°æ®åŸç†" tabindex="-1"><a class="header-anchor" href="#è¯»å†™æ•°æ®åŸç†" aria-hidden="true">#</a> è¯»å†™æ•°æ®åŸç†</h5><p>å†™å…¥æ•°æ®ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œé€šè¿‡coordinating node(åè°ƒèŠ‚ç‚¹)å¯¹documentè¿›è¡Œè·¯ç”±ï¼Œå°†è¯·æ±‚è½¬å‘ç»™å¯¹åº”çš„nodeå¤„ç†ï¼Œç„¶ååŒæ­¥åˆ°replica nodeï¼Œå¦‚æœå‘ç°primary nodeå’Œæ‰€æœ‰replica nodeå¤„ç†å®Œæˆåè¿”å›åè¯·æ±‚åˆ°å®¢æˆ·ç«¯</p><p>å†™å…¥æ•°æ®åº•å±‚åŸç†(refresh, flush, translog, merge)</p><ol><li>å…ˆå†™å…¥buffer(bufferé‡Œé¢æ•°æ®æœç´¢ä¸åˆ°ï¼‰åŒæ—¶å†™å…¥translogæ—¥å¿—æ–‡ä»¶ï¼›</li><li>bufferå¿«æ»¡ï¼Œæˆ–ä¸€æ®µæ—¶é—´åï¼Œå°†bufferæ•°æ®refreshåˆ°æ–°çš„OS cacheä¸­ï¼Œæ¯ç§’å°†OS cacheæ•°æ®å†™å…¥segment fileã€‚å¦‚æœæ¯ç§’æ²¡æœ‰æ–°æ•°æ®åˆ°bufferï¼Œä¼šåˆ›å»ºæ–°çš„ç©ºsegment fileï¼Œåªè¦bufferä¸­æ•°æ®è¢«refreshåˆ°OS cacheä¸­ï¼Œæ•°æ®å°±å¯ä»¥è¢«æœç´¢åˆ°ã€‚åªè¦æ•°æ®è¾“å…¥åˆ°OS cacheä¸­ï¼Œbufferå†…å®¹å°±æ¸…ç©ºã€‚åŒæ—¶æ•°æ®åˆ°shardåï¼Œä¼šå†™å…¥translogï¼Œæ¯éš”5ç§’å°†translogä¸­çš„æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜</li><li>å½“translogæ–‡ä»¶å˜å¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œä¼šè§¦å‘commitæ“ä½œï¼Œå°†ä¸€ä¸ªcommit pointå†™å…¥åˆ°ç£ç›˜æ–‡ä»¶ï¼Œæ ‡è¯†å¯¹åº”çš„æ‰€æœ‰segment fileï¼Œå°†OS cacheä¸­æ•°æ®fsyncåˆ°ç£ç›˜ï¼ˆåœ¨commitå‰ï¼Œæ‰€æœ‰æ•°æ®éƒ½åœ¨bufferæˆ–OS cacheä¸­ï¼Œä¸€æ—¦å®•æœºåˆ™æ•°æ®ä¸¢å¤±ï¼Œé‡å¯ä¼šè¯»å–translogæ—¥å¿—æ–‡ä»¶æ•°æ®æ¢å¤ï¼‰ã€‚å°†translogæ–‡ä»¶æ¸…ç©ºï¼Œé‡æ–°å¯åŠ¨ä¸€ä¸ªtranslogï¼Œé»˜è®¤æ¯éš”30åˆ†é’Ÿcommitã€‚æ•´ä¸ªcommitè¿‡ç¨‹å«åšä¸€ä¸ªflushæ“ä½œ</li><li>åˆ é™¤æ“ä½œï¼Œcommitæ—¶ä¼šäº§ç”Ÿ.delæ–‡ä»¶ï¼Œå°†docæ ‡è®°ä¸ºdeleteçŠ¶æ€</li><li>æ›´æ–°æ“ä½œï¼Œå°†åŸæ¥çš„docæ ‡è¯†ä¸ºdeleteçŠ¶æ€ï¼Œé‡æ–°å†™å…¥</li><li>ä¼šäº§ç”Ÿå¾ˆå¤šsegment fileæ–‡ä»¶ï¼Œå°†å®šæœŸæ‰§è¡Œmergeæ“ä½œï¼Œå°†å¤šä¸ªsegment fileåˆå¹¶ä¸ºä¸€ä¸ªï¼ŒåŒæ—¶å°†æ ‡è®°ä¸ºdeleteæ–‡ä»¶åˆ é™¤ï¼Œå°†æ–°segment fileå†™å…¥ç£ç›˜ï¼Œä¼šå†™ä¸€ä¸ªcommit pointï¼Œæ ‡è¯†æ‰€æœ‰æ–°çš„segment file</li></ol><p>è¯»æ•°æ®ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œé€šè¿‡coordinating nodeå¯¹documentè·¯ç”±è½¬å‘ï¼Œåœ¨primary shardåŠæ‰€æœ‰replicaä¸­éšæœºé€‰æ‹©ä¸€ä¸ªï¼Œè®©è¯»è¯·æ±‚è´Ÿè½½å‡è¡¡ï¼Œæ¥å—è¯·æ±‚çš„nodeï¼Œè¿”å›documentç»™coordinate nodeï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯</p><p>æœç´¢æ•°æ®ï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼Œé€šè¿‡coordinating nodeå°†æœç´¢è¯·æ±‚è½¬å‘ç»™æ‰€æœ‰çš„shardå¯¹åº”çš„primary shardæˆ–replica shardï¼Œæ¯ä¸ªshardå°†æœç´¢ç»“æœï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ï¼Œè¿”å›ç»™åè°ƒèŠ‚ç‚¹è¿›è¡Œæ•°æ®åˆå¹¶ï¼Œæ’åºï¼Œåˆ†é¡µç­‰æ“ä½œï¼Œç„¶åæ ¹æ®å”¯ä¸€æ ‡è¯†å»å„èŠ‚ç‚¹æ‹‰å–æ•°æ®ï¼Œæœ€åè¿”å›ç»™å®¢æˆ·ç«¯</p><p>æœç´¢åº•å±‚åŸç†</p><ol><li>å°†å¹¿æ’­è¯·æ±‚åˆ°æœç´¢çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„åˆ†ç‰‡æ‹·è´ï¼ŒæŸ¥è¯¢è¯·æ±‚å¯è¢«ä¸»åˆ†ç‰‡æˆ–å‰¯åˆ†ç‰‡å¤„ç†ï¼Œåè°ƒèŠ‚ç‚¹åœ¨ä¹‹åè¯·æ±‚è½®è¯¢æ‰€æœ‰åˆ†ç‰‡æ‹·è´</li><li>æ¯ä¸ªåˆ†ç‰‡å°†åœ¨æœ¬åœ°æ„å»ºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œè‹¥è¦æ±‚è¿”å›ç»“æœæ’åºä»fromå¼€å§‹æ•°é‡ä¸ºsizeçš„ç»“æœé›†ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šäº§ç”Ÿfrom+sizeçš„ç»“æœé›†ï¼Œç„¶ä¼šæŠŠç»“æœé›†ä¸­æ¯ä¸ªæ–‡æ¡£IDå’Œæ’åºæ‰€éœ€ä¿¡æ¯è¿”å›ç»™åè°ƒèŠ‚ç‚¹</li><li>åè°ƒèŠ‚ç‚¹å°†æ‰€æœ‰ç»“æœæ±‡æ€»ï¼Œè¿›è¡Œå…¨å±€æ’åºï¼Œç¡®å®šå®é™…éœ€è¦çš„æ–‡æ¡£ï¼Œå‘å«æœ‰è¯¥æ–‡æ¡£çš„åˆ†ç‰‡è¯·æ±‚ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯</li></ol><h4 id="react-vue" tabindex="-1"><a class="header-anchor" href="#react-vue" aria-hidden="true">#</a> React / Vue</h4><p>è™šæ‹ŸDOMï¼Œå°±æ˜¯ç”¨ä¸€ä¸ªJSå¯¹è±¡æè¿°ä¸€ä¸ªDOMèŠ‚ç‚¹ã€‚äº§ç”Ÿçš„åŸå› ä»¥åŠæœ€å¤§ç”¨é€”ï¼šæ•°æ®é©±åŠ¨è§†å›¾ï¼Œæ•°æ®å‘ç”Ÿå˜åŒ–è§†å›¾å°±è¦éšä¹‹æ›´æ–°ï¼Œæ›´æ–°è§†å›¾æ—¶éœ€è¦æ“ä½œDOMï¼Œè€Œæ“ä½œçœŸå®DOMéå¸¸è€—è´¹æ€§èƒ½ï¼Œå› ä¸ºæµè§ˆå™¨çš„æ ‡å‡†æŠŠDOMè®¾è®¡å¾—éå¸¸å¤æ‚ï¼ŒçœŸæ­£çš„DOMå…ƒç´ éå¸¸åºå¤§ã€‚å¯ä»¥ç”¨JSæ¨¡æ‹Ÿå‡ºä¸€ä¸ªDOMèŠ‚ç‚¹ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¹æ¯”å˜åŒ–å‰åçš„è™šæ‹ŸDOMèŠ‚ç‚¹ï¼Œé€šè¿‡DOM-Diffç®—æ³•è®¡ç®—å‡ºéœ€è¦æ›´æ–°çš„åœ°æ–¹ï¼Œç„¶åæ›´æ–°éœ€è¦æ›´æ–°çš„è§†å›¾ã€‚ä¼ ç»Ÿdiffç®—æ³•å¤æ‚åº¦o(n^3)</p><h5 id="react" tabindex="-1"><a class="header-anchor" href="#react" aria-hidden="true">#</a> React</h5><p>å°†Virtual DOMæ ‘è½¬æ¢æˆactual DOMæ ‘çš„æœ€å°‘æ“ä½œè¿‡ç¨‹ç§°ä¸ºåè°ƒ(Reconciliation)ã€‚V16ç‰ˆæœ¬å‰åè°ƒæœºåˆ¶æ˜¯Stack reconciler(ä¿®æ”¹æœŸé—´ï¼Œä¸»çº¿ç¨‹è¢«jså ç”¨ï¼Œå› æ­¤ä»»ä½•äº¤äº’ã€å¸ƒå±€ã€æ¸²æŸ“éƒ½ä¼šåœæ­¢)ï¼Œdiffç®—æ³•ç­–ç•¥ï¼ˆå¤æ‚åº¦o(n)ï¼‰</p><ol><li>web UIè·¨çº§ç§»åŠ¨æ“ä½œéå¸¸å°‘ï¼Œå¯å¿½ç•¥ä¸è®¡(tree diff)</li><li>æ‹¥æœ‰ç›¸åŒç±»å‹çš„ä¸¤ä¸ªç»„ä»¶äº§ç”Ÿçš„DOMç»“æ„ç›¸ä¼¼ï¼Œåä¹‹åˆ™ä¸å°½ç›¸åŒ(component diff, ReactåŸºäºç»„ä»¶å¼€å‘)</li><li>å¯¹äºåŒä¸€å±‚çº§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œé€šè¿‡åˆ†é…å”¯ä¸€idè¿›è¡ŒåŒºåˆ†(Element diff)</li></ol><p>V16ç‰ˆæœ¬æ˜¯Fiber reconciler(Fiber, çº¤ç»´ï¼Œæ¯”çº¿ç¨‹æ§åˆ¶å¾—æ›´ç²¾å¯†çš„å¹¶å‘å¤„ç†æœºåˆ¶ï¼Œå°†ä»»åŠ¡åˆ†ç‰‡ï¼Œåˆ’åˆ†ä¼˜å…ˆçº§ï¼ŒåŒæ—¶èƒ½å¤Ÿå®ç°ç±»ä¼¼æ“ä½œç³»ç»Ÿä¸­å¯¹çº¿ç¨‹æŠ¢å å¼è°ƒåº¦ï¼Œpackages\react-reconciler\src ReactInternalTypes.js )ï¼Œä»ä¾èµ–äºå†…ç½®å †æ ˆçš„åŒæ­¥é€’å½’æ¨¡å‹ï¼Œå˜ä¸ºå…·æœ‰é“¾è¡¨å’ŒæŒ‡é’ˆçš„å¼‚æ­¥æ¨¡å‹ï¼Œæ¯ä¸ªElementå¯¹åº”ä¸€ä¸ªFiber Nodeï¼Œæˆä¸ºFiber Treeï¼ˆå±‚æ¬¡éå†ï¼Œdiffç­–ç•¥å»ºç«‹åœ¨èŠ‚ç‚¹æ“ä½œéƒ½åœ¨èŠ‚ç‚¹æ ‘åŒä¸€å±‚çº§ä¸­è¿›è¡Œï¼‰ï¼Œè®°å½•å½“å‰é¡µé¢çŠ¶æ€ï¼Œé‡‡ç”¨åŒç¼“å­˜çš„ç­–ç•¥(double buffering)ï¼Œåˆ›å»ºWorkInProgress Tree, åæ˜ è¦åˆ·æ–°åˆ°å±å¹•çš„æœªæ¥çŠ¶æ€ï¼Œæ„é€ å®Œæ¯•ï¼Œå°†å½“å‰æŒ‡é’ˆæŒ‡å‘WorkInProgress Treeï¼Œä¸¢å¼ƒæ—§Fiber Treeï¼Œå¤ç”¨å†…éƒ¨å¯¹è±¡(fiber)ï¼ŒèŠ‚çœå†…å­˜åˆ†é…å’ŒGCæ—¶é—´å¼€é”€ã€‚</p><h5 id="vue" tabindex="-1"><a class="header-anchor" href="#vue" aria-hidden="true">#</a> Vue</h5><p>VNodeç±»(src/core/vdom/vnode.js)å¯ä»¥å®ä¾‹å‡ºä¸åŒç±»å‹çš„è™šæ‹ŸDOMèŠ‚ç‚¹ï¼Œè§†å›¾æ¸²æŸ“å‰ï¼Œtemplateæ¨¡æ¿å…ˆç¼–è¯‘æˆVNodeå¹¶ç¼“å­˜ï¼Œæ•°æ®å˜åŒ–åç”Ÿæˆçš„VNodeä¸å‰ä¸€æ¬¡ç¼“å­˜çš„VNodeæ¯”è¾ƒï¼Œæœ‰å·®å¼‚çš„VNodeå¯¹åº”çš„çœŸå®DOMèŠ‚ç‚¹é‡æ–°æ¸²æŸ“æ’å…¥è§†å›¾ï¼Œå®Œæˆä¸€æ¬¡è§†å›¾æ›´æ–°</p><p>diffç­–ç•¥ï¼šåªè¿›è¡ŒåŒå±‚çº§æ¯”è¾ƒï¼Œå¿½ç•¥è·¨çº§æ“ä½œï¼ˆsrc/core/vdom/patch.jsï¼‰</p><h4 id="hbase" tabindex="-1"><a class="header-anchor" href="#hbase" aria-hidden="true">#</a> HBase</h4><p>åŸºäºåˆ—å­˜å‚¨ï¼Œæ•°æ®æŒä¹…åŒ–åœ¨HDFSï¼ˆHDFSå—blockè®¾ç½®ï¼Œå¦‚æœè¿‡å¤§ï¼Œä»ç£ç›˜ä¼ è¾“æ•°æ®æ—¶é—´ä¼šæ˜æ˜¾å¤§äºå¯»å€æ—¶é—´ï¼Œå¯¼è‡´å¤„ç†æ•°æ®æ—¶è¾ƒæ…¢ï¼Œå¦‚æœè¿‡å°ï¼Œå¤§é‡å°æ–‡ä»¶ä¼šå ç”¨NameNodeå¤§é‡å†…å­˜å­˜å‚¨å…ƒæ•°æ®ï¼Œå¯»å€æ—¶é—´å¢å¤§ï¼ŒHDFSä¸­å‡­æ®å¯»å€æ—¶é—´å¤§æ¦‚ä¸º10msï¼Œå½“å¯»å€æ—¶é—´ä¸ºä¼ è¾“æ—¶é—´çš„1%ï¼Œä¸ºæœ€ä½³çŠ¶æ€ï¼Œç›®å‰ç£ç›˜ä¼ è¾“é€Ÿç‡æ™®éä¸º100MB/sï¼Œæœ€ä½³blockå¤§å°ä¸º100MBï¼Œè®¾ä¸º128MBï¼‰ã€‚åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œä½¿ç”¨zookeeperç®¡ç†é›†ç¾¤ï¼Œåˆ†ä¸ºMasterå’ŒRegionServer</p><h4 id="mongodb" tabindex="-1"><a class="header-anchor" href="#mongodb" aria-hidden="true">#</a> MongoDB</h4><h4 id="kafka" tabindex="-1"><a class="header-anchor" href="#kafka" aria-hidden="true">#</a> Kafka</h4><p>å·¥ä½œæ¨¡å¼ï¼šå¯åŠ¨zookeeperçš„serverï¼›å¯åŠ¨kafkaçš„serverï¼›producerç”Ÿäº§æ•°æ®ï¼Œé€šè¿‡zookeeperæ‰¾åˆ°broker(æ¯ä¸ªkafkaå®ä¾‹ç§°ä¸ºbroker)ï¼Œå†å°†æ•°æ®pushåˆ°Brokerä¿å­˜ï¼›customeré€šè¿‡zookeeperæ‰¾åˆ°brokerï¼Œå†ä¸»åŠ¨pullæ•°æ®</p><p>Producer: ç”Ÿäº§messageåˆ°topic</p><p>Consumer: è®¢é˜…topicæ¶ˆè´¹messageï¼Œconsumerä½œä¸ºä¸€ä¸ªçº¿ç¨‹æ¶ˆè´¹ï¼Œæ¶ˆè´¹æ¶ˆæ¯ç­–ç•¥ï¼ˆroundrobinï¼‰</p><p>Consumer Group: åŒ…å«å¤šä¸ªconsumerï¼Œç»´æŠ¤ä¸€ä¸ªä¸‹æ ‡æ–‡ä»¶offsetï¼Œè®°å½•å½“å‰ç»„æ¶ˆè´¹æ•°æ®ä¸‹æ ‡ï¼Œæ¶ˆè´¹ä¸€æ¡ï¼Œoffseté€’å¢1ã€‚partitionä¸­æ¯ä¸ªmessageåªèƒ½è¢«ä¸€ä¸ªç»„ä¸­çš„consumeræ¶ˆè´¹ï¼Œå…¶ä»–consumerä¸èƒ½æ¶ˆè´¹åŒä¸€topicä¸­åŒä¸€åˆ†åŒºçš„æ•°æ®ï¼Œä¸åŒç»„consumerå¯ä»¥æ¶ˆè´¹åŒä¸€topicåŒä¸€åˆ†åŒºçš„æ•°æ®</p><p>Brokerï¼škafkaèŠ‚ç‚¹(ä¸­é—´å­˜å‚¨é˜µåˆ—)ï¼Œå¤šä¸ªbrokerç»„æˆkafkaé›†ç¾¤ï¼Œè´Ÿè´£æŒä¹…åŒ–å’Œå¤‡ä»½å…·ä½“kafkaæ¶ˆæ¯</p><p>Topic: ä¸€ç±»æ¶ˆæ¯ï¼Œæ¶ˆæ¯å­˜æ”¾çš„ç›®å½•å³ä¸»é¢˜ï¼ˆè½®è¯¢ï¼šé¡ºåºåˆ†å‘ï¼Œä»…é’ˆå¯¹messageæ²¡æœ‰keyæ—¶ï¼›Hashåˆ†åŒºï¼šmessageæœ‰keyæ—¶ï¼Œkey.hash%åˆ†åŒºä¸ªæ•°ï¼Œå¢åŠ åˆ†åŒºæ—¶ï¼Œpartitioné‡Œçš„messageä¸ä¼šé‡åˆ†é…ï¼Œæ•°æ®ç»§ç»­å†™å…¥æ‰ä¼šå‚ä¸load balanceï¼‰</p><p>Partition: åˆ†åŒºï¼Œtopicç‰©ç†ä¸Šåˆ†ç»„ï¼Œæ¯ä¸ªpartitionæ˜¯ä¸€ä¸ªæœ‰åºçš„é˜Ÿåˆ—ï¼Œå¯¹åº”æ–‡ä»¶å¤¹{topicname}{partition}{åºå·}ï¼Œé›†ç¾¤è´Ÿè½½å‡è¡¡åŸºæœ¬å•ä½ï¼Œæ¯æ¡æ¶ˆæ¯åœ¨partitionä¸­ä½ç½®ç§°ä¸ºoffsetåç§»é‡ï¼Œç±»å‹ä¸ºlongå‹æ•°å­—ï¼Œæ¶ˆæ¯è¢«æ¶ˆè´¹ï¼Œä¸ä¼šç«‹å³åˆ é™¤ï¼Œæ ¹æ®borkerè®¾ç½®(åŸºäºæ—¶é—´å­˜å‚¨æˆ–åŸºäºå¤§å°)ï¼Œåˆ°æœŸä¸ç®¡æ¶ˆæ¯æ˜¯å¦æ¶ˆè´¹ï¼Œéƒ½æ¸…é™¤</p><p>Segment: partitionç‰©ç†ä¸Šç”±å¤šä¸ªsegmentç»„æˆï¼Œæ¯ä¸ªSegmentå­˜å‚¨å¤šä¸ªmessageä¿¡æ¯ï¼ˆé»˜è®¤1Gï¼Œ7å¤©ååˆ é™¤ï¼‰ï¼Œæ¯ä¸ªmessageç”±key-valueå’Œæ—¶é—´æˆ³ç»„æˆã€‚åŒ…æ‹¬index fileï¼ˆ.indexï¼Œå…ƒæ•°æ®æŒ‡å‘æ•°æ®æ–‡ä»¶messageç‰©ç†åç§»åœ°å€ï¼‰å’Œdata file(.log)ã€‚ç¬¬ä¸€ä¸ªsegmentæ–‡ä»¶åä»0å¼€å§‹ï¼Œåç»­ä¸ºä¸Šä¸€ä¸ªæœ€åä¸€æ¡æ¶ˆæ¯çš„offsetï¼Œæ•°å­—æœ€å¤§ä¸º64ä½longï¼Œ19ä½æ•°å­—å­—ç¬¦é•¿åº¦ï¼Œæ²¡æœ‰æ•°å­—ç”¨0å¡«å……</p><p>Segment data file</p><table><thead><tr><th style="text-align:left;">8 byte offset</th><th>æ¶ˆæ¯id(offset)</th></tr></thead><tbody><tr><td style="text-align:left;">4 byte message size</td><td>messageå¤§å°</td></tr><tr><td style="text-align:left;">4 byte CRC32</td><td>ç”¨crc32æ ¡éªŒmessage</td></tr><tr><td style="text-align:left;">1 byte magic</td><td>kafkaæœåŠ¡ç¨‹åºåè®®ç‰ˆæœ¬å·</td></tr><tr><td style="text-align:left;">1 byte attributes</td><td>ç‹¬ç«‹ç‰ˆæœ¬ã€æˆ–æ ‡è¯†å‹ç¼©ç±»å‹ã€æˆ–ç¼–ç ç±»å‹</td></tr><tr><td style="text-align:left;">4 byte key length</td><td>keyçš„é•¿åº¦ï¼Œkeyä¸º-1æ—¶ï¼ŒK byte keyå­—æ®µä¸å¡«</td></tr><tr><td style="text-align:left;">K byte key</td><td>å¯é€‰</td></tr><tr><td style="text-align:left;">value bytes payload</td><td>å®é™…æ¶ˆæ¯æ•°æ®</td></tr></tbody></table><p>æŸ¥æ‰¾messageæ­¥éª¤ï¼šæ ¹æ®offsetäºŒåˆ†æŸ¥æ‰¾æ–‡ä»¶åˆ—è¡¨ï¼Œå®šä½æ–‡ä»¶ï¼Œåœ¨.indexæ–‡ä»¶ä¸­æœ‰ä¸¤åˆ—ï¼ˆåºåˆ—ï¼Œåœ°å€ï¼‰ï¼Œå…¶ä¸­åºåˆ—=æŸ¥æ‰¾messageçš„åç§»é‡-å½“å‰æ–‡ä»¶çš„èµ·å§‹åç§»é‡ï¼Œæ ¹æ®åºåˆ—å¯¹åº”çš„åœ°å€ï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®çš„message</p><p>zookeeperä¿å­˜Consumerå’ŒProducerä¿¡æ¯</p><h4 id="rabbitmq" tabindex="-1"><a class="header-anchor" href="#rabbitmq" aria-hidden="true">#</a> RabbitMQ</h4><h4 id="rocketmq" tabindex="-1"><a class="header-anchor" href="#rocketmq" aria-hidden="true">#</a> RocketMQ</h4></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/æ•°æ®ç»“æ„ä¸ç®—æ³•/å¤§è¯æ•°æ®ç»“æ„.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: refersearch@163.com">wuyanluoye</span><!--]--><!--]--></div></div></footer><!----><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">æµ‹è¯•é¡µè„š</div><div class="vp-copyright">Copyright Â© 2023 Mr.Hope</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-lybKqyLW.js" defer></script>
  </body>
</html>
